"use strict";(self.webpackChunkbabylon_bulletphysics=self.webpackChunkbabylon_bulletphysics||[]).push([[9297],{39297:(t,e,n)=>{n.r(e),n.d(e,{SceneBuilder:()=>re});var i={};n.r(i),n.d(i,{allocateBuffer:()=>N,constraintEnableSpring:()=>Ut,constraintSetAngularLowerLimit:()=>kt,constraintSetAngularUpperLimit:()=>qt,constraintSetDamping:()=>It,constraintSetLinearLowerLimit:()=>Dt,constraintSetLinearUpperLimit:()=>xt,constraintSetStiffness:()=>Et,createBoxShape:()=>tt,createCapsuleShape:()=>nt,createGeneric6DofConstraint:()=>Lt,createGeneric6DofConstraintFromBundle:()=>Mt,createGeneric6DofSpringConstraint:()=>Ct,createGeneric6DofSpringConstraintFromBundle:()=>Gt,createMultiPhysicsRuntime:()=>$,createMultiPhysicsWorld:()=>L,createPhysicsRuntime:()=>Ft,createPhysicsWorld:()=>pt,createRigidBody:()=>rt,createRigidBodyBundle:()=>lt,createSphereShape:()=>et,createStaticPlaneShape:()=>it,deallocateBuffer:()=>X,default:()=>Xt,destroyConstraint:()=>Tt,destroyMultiPhysicsRuntime:()=>J,destroyMultiPhysicsWorld:()=>C,destroyPhysicsRuntime:()=>Ot,destroyPhysicsWorld:()=>wt,destroyRigidBody:()=>st,destroyRigidBodyBundle:()=>ft,destroyShape:()=>ot,init:()=>H,initSync:()=>Ht,multiPhysicsRuntimeGetLockStatePtr:()=>V,multiPhysicsWorldAddConstraint:()=>K,multiPhysicsWorldAddRigidBody:()=>D,multiPhysicsWorldAddRigidBodyBundle:()=>k,multiPhysicsWorldAddRigidBodyBundleShadow:()=>Z,multiPhysicsWorldAddRigidBodyBundleToGlobal:()=>I,multiPhysicsWorldAddRigidBodyShadow:()=>O,multiPhysicsWorldAddRigidBodyToGlobal:()=>U,multiPhysicsWorldRemoveConstraint:()=>z,multiPhysicsWorldRemoveRigidBody:()=>x,multiPhysicsWorldRemoveRigidBodyBundle:()=>q,multiPhysicsWorldRemoveRigidBodyBundleFromGlobal:()=>F,multiPhysicsWorldRemoveRigidBodyBundleShadow:()=>Q,multiPhysicsWorldRemoveRigidBodyFromGlobal:()=>E,multiPhysicsWorldRemoveRigidBodyShadow:()=>j,multiPhysicsWorldSetGravity:()=>G,multiPhysicsWorldStepSimulation:()=>T,multiPhysicsWorldUseMotionStateBuffer:()=>Y,physicsRuntimeGetLockStatePtr:()=>jt,physicsWorldAddConstraint:()=>vt,physicsWorldAddRigidBody:()=>St,physicsWorldAddRigidBodyBundle:()=>Pt,physicsWorldRemoveConstraint:()=>_t,physicsWorldRemoveRigidBody:()=>Rt,physicsWorldRemoveRigidBodyBundle:()=>Wt,physicsWorldSetGravity:()=>Bt,physicsWorldStepSimulation:()=>bt,physicsWorldUseMotionStateBuffer:()=>At,rigidBodyBundleGetBufferedMotionStatesPtr:()=>ht,rigidBodyBundleGetMotionStatesPtr:()=>yt,rigidBodyBundleMakeKinematic:()=>mt,rigidBodyBundleRestoreDynamic:()=>gt,rigidBodyGetBufferedMotionStatePtr:()=>at,rigidBodyGetMotionStatePtr:()=>dt,rigidBodyMakeKinematic:()=>ct,rigidBodyRestoreDynamic:()=>ut}),n(90203),n(33832),n(2093);var o=n(7839),r=n(52046),s=n(71513),d=n(18595),a=n(26041),c=n(79923),u=n(96793),l=n(58144),f=n(87491),y=n(46738),h=n(67168),m=n(23948),g=n(29009),p=n(47002);let w;const B="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&B.decode();let b=null;function S(){return null!==b&&0!==b.byteLength||(b=new Uint8Array(w.memory.buffer)),b}function R(t,e){return t>>>=0,B.decode(S().subarray(t,t+e))}const P=new Array(128).fill(void 0);P.push(void 0,null,!0,!1);let W=P.length;function v(t){W===P.length&&P.push(P.length+1);const e=W;if(W=P[e],"number"!=typeof W)throw new Error("corrupt heap");return P[e]=t,e}function _(t){return P[t]}function A(t){if("boolean"!=typeof t)throw new Error("expected a boolean argument, found "+typeof t)}function L(t){return A(t),w.createMultiPhysicsWorld(t)>>>0}function M(t){if("number"!=typeof t)throw new Error("expected a number argument, found "+typeof t)}function C(t){M(t),w.destroyMultiPhysicsWorld(t)}function G(t,e,n,i){M(t),w.multiPhysicsWorldSetGravity(t,e,n,i)}function T(t,e,n,i){M(t),M(n),w.multiPhysicsWorldStepSimulation(t,e,n,i)}function D(t,e,n){M(t),M(e),M(n),w.multiPhysicsWorldAddRigidBody(t,e,n)}function x(t,e,n){M(t),M(e),M(n),w.multiPhysicsWorldRemoveRigidBody(t,e,n)}function k(t,e,n){M(t),M(e),M(n),w.multiPhysicsWorldAddRigidBodyBundle(t,e,n)}function q(t,e,n){M(t),M(e),M(n),w.multiPhysicsWorldRemoveRigidBodyBundle(t,e,n)}function U(t,e){M(t),M(e),w.multiPhysicsWorldAddRigidBodyToGlobal(t,e)}function E(t,e){M(t),M(e),w.multiPhysicsWorldRemoveRigidBodyFromGlobal(t,e)}function I(t,e){M(t),M(e),w.multiPhysicsWorldAddRigidBodyBundleToGlobal(t,e)}function F(t,e){M(t),M(e),w.multiPhysicsWorldRemoveRigidBodyBundleFromGlobal(t,e)}function O(t,e,n){M(t),M(e),M(n),w.multiPhysicsWorldAddRigidBodyShadow(t,e,n)}function j(t,e,n){M(t),M(e),M(n),w.multiPhysicsWorldRemoveRigidBodyShadow(t,e,n)}function Z(t,e,n){M(t),M(e),M(n),w.multiPhysicsWorldAddRigidBodyBundleShadow(t,e,n)}function Q(t,e,n){M(t),M(e),M(n),w.multiPhysicsWorldRemoveRigidBodyBundleShadow(t,e,n)}function K(t,e,n,i){M(t),M(e),M(n),A(i),w.multiPhysicsWorldAddConstraint(t,e,n,i)}function z(t,e,n){M(t),M(e),M(n),w.multiPhysicsWorldRemoveConstraint(t,e,n)}function Y(t,e){M(t),A(e),w.multiPhysicsWorldUseMotionStateBuffer(t,e)}function $(t){return M(t),w.createMultiPhysicsRuntime(t)>>>0}function J(t){M(t),w.destroyMultiPhysicsRuntime(t)}function V(t){return M(t),w.multiPhysicsRuntimeGetLockStatePtr(t)>>>0}function H(){w.init()}function N(t){return M(t),w.allocateBuffer(t)>>>0}function X(t,e){M(t),M(e),w.deallocateBuffer(t,e)}function tt(t,e,n){return w.createBoxShape(t,e,n)>>>0}function et(t){return w.createSphereShape(t)>>>0}function nt(t,e){return w.createCapsuleShape(t,e)>>>0}function it(t,e,n,i){return w.createStaticPlaneShape(t,e,n,i)>>>0}function ot(t){M(t),w.destroyShape(t)}function rt(t){return M(t),w.createRigidBody(t)>>>0}function st(t){M(t),w.destroyRigidBody(t)}function dt(t){return M(t),w.rigidBodyGetMotionStatePtr(t)>>>0}function at(t){return M(t),w.rigidBodyGetBufferedMotionStatePtr(t)>>>0}function ct(t){M(t),w.rigidBodyMakeKinematic(t)}function ut(t){M(t),w.rigidBodyRestoreDynamic(t)}function lt(t,e){return M(t),M(e),w.createRigidBodyBundle(t,e)>>>0}function ft(t){M(t),w.destroyRigidBodyBundle(t)}function yt(t){return M(t),w.rigidBodyBundleGetMotionStatesPtr(t)>>>0}function ht(t){return M(t),w.rigidBodyBundleGetBufferedMotionStatesPtr(t)>>>0}function mt(t,e){M(t),M(e),w.rigidBodyBundleMakeKinematic(t,e)}function gt(t,e){M(t),M(e),w.rigidBodyBundleRestoreDynamic(t,e)}function pt(){return w.createPhysicsWorld()>>>0}function wt(t){M(t),w.destroyPhysicsWorld(t)}function Bt(t,e,n,i){M(t),w.physicsWorldSetGravity(t,e,n,i)}function bt(t,e,n,i){M(t),M(n),w.physicsWorldStepSimulation(t,e,n,i)}function St(t,e){M(t),M(e),w.physicsWorldAddRigidBody(t,e)}function Rt(t,e){M(t),M(e),w.physicsWorldRemoveRigidBody(t,e)}function Pt(t,e){M(t),M(e),w.physicsWorldAddRigidBodyBundle(t,e)}function Wt(t,e){M(t),M(e),w.physicsWorldRemoveRigidBodyBundle(t,e)}function vt(t,e,n){M(t),M(e),A(n),w.physicsWorldAddConstraint(t,e,n)}function _t(t,e){M(t),M(e),w.physicsWorldRemoveConstraint(t,e)}function At(t,e){M(t),A(e),w.physicsWorldUseMotionStateBuffer(t,e)}function Lt(t,e,n,i,o){return M(t),M(e),M(n),M(i),A(o),w.createGeneric6DofConstraint(t,e,n,i,o)>>>0}function Mt(t,e,n,i,o,r){return M(t),M(e),M(n),M(i),M(o),A(r),w.createGeneric6DofConstraintFromBundle(t,e,n,i,o,r)>>>0}function Ct(t,e,n,i,o){return M(t),M(e),M(n),M(i),A(o),w.createGeneric6DofSpringConstraint(t,e,n,i,o)>>>0}function Gt(t,e,n,i,o,r){return M(t),M(e),M(n),M(i),M(o),A(r),w.createGeneric6DofSpringConstraintFromBundle(t,e,n,i,o,r)>>>0}function Tt(t){M(t),w.destroyConstraint(t)}function Dt(t,e,n,i){M(t),w.constraintSetLinearLowerLimit(t,e,n,i)}function xt(t,e,n,i){M(t),w.constraintSetLinearUpperLimit(t,e,n,i)}function kt(t,e,n,i){M(t),w.constraintSetAngularLowerLimit(t,e,n,i)}function qt(t,e,n,i){M(t),w.constraintSetAngularUpperLimit(t,e,n,i)}function Ut(t,e,n){M(t),M(e),A(n),w.constraintEnableSpring(t,e,n)}function Et(t,e,n){M(t),M(e),w.constraintSetStiffness(t,e,n)}function It(t,e,n){M(t),M(e),w.constraintSetDamping(t,e,n)}function Ft(t){return M(t),w.createPhysicsRuntime(t)>>>0}function Ot(t){M(t),w.destroyPhysicsRuntime(t)}function jt(t){return M(t),w.physicsRuntimeGetLockStatePtr(t)>>>0}function Zt(t,e){try{return t.apply(this,e)}catch(t){let e=function(){try{return t instanceof Error?`${t.message}\n\nStack:\n${t.stack}`:t.toString()}catch(t){return"<failed to stringify thrown value>"}}();throw console.error("wasm-bindgen: imported JS function that was not marked as `catch` threw an error:",e),t}}let Qt=0;const Kt="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},zt="function"==typeof Kt.encodeInto?function(t,e){return Kt.encodeInto(t,e)}:function(t,e){const n=Kt.encode(t);return e.set(n),{read:t.length,written:n.length}};let Yt=null;function $t(){return(null===Yt||!0===Yt.buffer.detached||void 0===Yt.buffer.detached&&Yt.buffer!==w.memory.buffer)&&(Yt=new DataView(w.memory.buffer)),Yt}function Jt(){const t={wbg:{}};return t.wbg.__wbindgen_string_new=function(t,e){return v(R(t,e))},t.wbg.__wbindgen_object_drop_ref=function(t){!function(t){const e=_(t);(function(t){t<132||(P[t]=W,W=t)})(t)}(t)},t.wbg.__wbg_new_abda76e883ba8a5f=function(){return Zt((function(){return v(new Error)}),arguments)},t.wbg.__wbg_stack_658279fe44541cf6=function(){return Zt((function(t,e){const n=function(t,e,n){if("string"!=typeof t)throw new Error("expected a string argument, found "+typeof t);if(void 0===n){const n=Kt.encode(t),i=e(n.length,1)>>>0;return S().subarray(i,i+n.length).set(n),Qt=n.length,i}let i=t.length,o=e(i,1)>>>0;const r=S();let s=0;for(;s<i;s++){const e=t.charCodeAt(s);if(e>127)break;r[o+s]=e}if(s!==i){0!==s&&(t=t.slice(s)),o=n(o,i,i=s+3*t.length,1)>>>0;const e=S().subarray(o+s,o+i),r=zt(t,e);if(r.read!==t.length)throw new Error("failed to pass whole string");s+=r.written,o=n(o,i,s,1)>>>0}return Qt=s,o}(_(e).stack,w.__wbindgen_malloc,w.__wbindgen_realloc),i=Qt;$t().setInt32(t+4,i,!0),$t().setInt32(t+0,n,!0)}),arguments)},t.wbg.__wbg_error_f851667af71bcfc6=function(){return Zt((function(t,e){let n,i;try{n=t,i=e,console.error(R(t,e))}finally{w.__wbindgen_free(n,i,1)}}),arguments)},t.wbg.__wbg_error_09480e4aadca50ad=function(){return Zt((function(t){console.error(_(t))}),arguments)},t.wbg.__wbg_log_b103404cc5920657=function(){return Zt((function(t){console.log(_(t))}),arguments)},t.wbg.__wbindgen_throw=function(t,e){throw new Error(R(t,e))},t}function Vt(t,e){return w=t.exports,Nt.__wbindgen_wasm_module=e,Yt=null,b=null,w}function Ht(t){if(void 0!==w)return w;void 0!==t&&Object.getPrototypeOf(t)===Object.prototype?({module:t}=t):console.warn("using deprecated parameters for `initSync()`; pass a single object instead");const e=Jt();return t instanceof WebAssembly.Module||(t=new WebAssembly.Module(t)),Vt(new WebAssembly.Instance(t,e),t)}async function Nt(t){if(void 0!==w)return w;void 0!==t&&Object.getPrototypeOf(t)===Object.prototype?({module_or_path:t}=t):console.warn("using deprecated parameters for the initialization function; pass a single object instead"),void 0===t&&(t=new URL(n(24871),n.b));const e=Jt();("string"==typeof t||"function"==typeof Request&&t instanceof Request||"function"==typeof URL&&t instanceof URL)&&(t=fetch(t));const{instance:i,module:o}=await async function(t,e){if("function"==typeof Response&&t instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(t,e)}catch(e){if("application/wasm"==t.headers.get("Content-Type"))throw e;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e)}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}(await t,e);return Vt(i,o)}const Xt=Nt;var te=n(26405),ee=n(1592),ne=n(67648),ie=n(35901),oe=n(3477);class re{async build(t,e){const n=new f.Z(e);n.clearColor=new a.ov(.95,.95,.95,1);const i=new o.L("arcRotateCamera",0,0,500,new c.Pq(0,0,0),n);i.minZ=1,i.maxZ=3e3,i.setPosition(new c.Pq(60,40,-50).scaleInPlace(10)),i.attachControl(void 0,!1),i.inertia=.8,i.speed=10;const w=new s.g("hemisphericLight",new c.Pq(0,1,0),n);w.intensity=.5,w.specular=new a.v9(0,0,0),w.groundColor=new a.v9(1,1,1);const B=new r.Z("directionalLight",new c.Pq(.5,-1,1),n);B.intensity=.5;B.shadowMaxZ=250,B.shadowMinZ=-250,B.autoCalcShadowZBounds=!1,B.autoUpdateExtends=!1,B.shadowOrthoScale=0,B.orthoTop=250,B.orthoBottom=-250,B.orthoLeft=-250,B.orthoRight=250;const b=new d.o(2048,B,!0);b.transparencyShadow=!0,b.usePercentageCloserFiltering=!0,b.forceBackFacesOnly=!1,b.bias=.004,b.filteringQuality=d.o.QUALITY_MEDIUM;const S=await(0,y.e)(new p.t,32),R=new m.h(S,{allowDynamicShadow:!0,preserveBackBuffer:!0});R.register(n),R.evaluationType=g.q.Buffered;const P=new c.uq;{const t=(0,l.x)("ground",{size:500},n);t.rotationQuaternion=c.PT.RotationAxis(new c.Pq(1,0,0),Math.PI/2),b.addShadowCaster(t),t.receiveShadows=!0;const e=new te.Ty(R,new c.Pq(0,0,-1),0),i=new ie.t(S);i.shape=e,c.uq.FromQuaternionToRef(t.rotationQuaternion,P),i.setInitialTransform(P),i.motionType=1;const o=new ee.U(R,i);R.addRigidBodyToGlobal(o)}const W=512,v=(0,u.an)("box",{size:2},n);b.addShadowCaster(v),v.receiveShadows=!0;const _=new Float32Array(262144);v.thinInstanceSetBuffer("matrix",_,16,!1);const A=new te.SA(R,new c.Pq(1,1,1)),L=[];for(let t=0;t<4;++t)for(let e=0;e<8;++e){const n=8*t+e,i=60*(e-4)+30,o=60*(t-2)+30,r=new oe.x(S,W);for(let t=0;t<W;++t){r.setShape(t,A);const e=c.uq.TranslationToRef(i,1+2*t,o,P);r.setInitialTransform(t,e),r.setFriction(t,1),r.setLinearDamping(t,.3),r.setAngularDamping(t,.3)}const s=new ne.Y(R,r);R.addRigidBodyBundle(s,n);for(let t=0;t<W;t+=2){const e=[t,t+1],i=new h.vC(R,s,e,c.uq.Translation(0,-1.2,0),c.uq.Translation(0,1.2,0),!0);i.setLinearLowerLimit(new c.Pq(0,0,0)),i.setLinearUpperLimit(new c.Pq(0,0,0)),i.setAngularLowerLimit(new c.Pq(Math.PI/4,0,0)),i.setAngularUpperLimit(new c.Pq(0,0,0));for(let t=0;t<6;++t)i.enableSpring(t,!0),i.setStiffness(t,100),i.setDamping(t,1);R.addConstraint(i,n,!1)}L.push(s)}return R.onTickObservable.add((()=>{for(let t=0;t<L.length;++t)L[t].getTransformMatricesToArray(_,t*W*16);v.thinInstanceBufferUpdated("matrix")})),n}}},24871:(t,e,n)=>{t.exports=n.p+"4822f9a5409fd620df77.wasm"}}]);