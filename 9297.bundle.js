"use strict";(self.webpackChunkbabylon_bulletphysics=self.webpackChunkbabylon_bulletphysics||[]).push([[9297],{4871:(e,t,n)=>{e.exports=n.p+"2ef4e74151ab2d2a0291.wasm"},7168:(e,t,n)=>{n.d(t,{o6:()=>a,vC:()=>c});class i{_wasmInstance;_ptr;_bodyReference;_referenceCount;constructor(e,t,n){this._wasmInstance=e,this._ptr=t,this._bodyReference=n,Array.isArray(n)?(n[0].addReference(),n[1].addReference()):n.addReference(),this._referenceCount=0}dispose(){if(this._referenceCount>0)throw new Error("Cannot dispose constraint while it still has references");0!==this._ptr&&(this._wasmInstance.deref()?.destroyConstraint(this._ptr),this._ptr=0,Array.isArray(this._bodyReference)?(this._bodyReference[0].removeReference(),this._bodyReference[1].removeReference()):this._bodyReference.removeReference(),this._bodyReference=null)}get ptr(){return this._ptr}addReference(){this._referenceCount+=1}removeReference(){this._referenceCount-=1}get hasReferences(){return 0<this._referenceCount}}function r(e){e.dispose()}const o=new WeakMap;class d{runtime;_inner;_worldReference;constructor(e,t,n){if(Array.isArray(n)){if(n[0].runtime!==e||n[1].runtime!==e)throw new Error("Cannot create constraint between bodies from different runtimes")}else if(n.runtime!==e)throw new Error("Cannot create constraint between body and bundle from different runtimes");this.runtime=e,this._inner=new i(new WeakRef(e.wasmInstance),t,n),this._worldReference=null;let d=o.get(e.wasmInstance);void 0===d&&(d=new FinalizationRegistry(r),o.set(e.wasmInstance,d)),d.register(this,this._inner,this)}dispose(){if(0===this._inner.ptr)return;this._inner.dispose();const e=o.get(this.runtime.wasmInstance);e?.unregister(this)}get ptr(){return this._inner.ptr}addReference(){this._inner.addReference()}removeReference(){this._inner.removeReference()}setWorldReference(e){if(null!==this._worldReference&&null!==e)throw new Error("Cannot add constraint to multiple worlds");this._worldReference!==e&&(this._worldReference=e,null!==e?this._inner.addReference():this._inner.removeReference())}}const s=64;class a extends d{constructor(e,t,n,i,r,o){const d=e.wasmInstance,a=d.allocateBuffer(s),c=d.createTypedArray(Float32Array,a,16);i.copyToArray(c.array);const u=d.allocateBuffer(s),l=d.createTypedArray(Float32Array,u,16);r.copyToArray(l.array);const y=Array.isArray(n),f=y?d.createGeneric6DofConstraintFromBundle(t.ptr,n[0],n[1],a,u,o):d.createGeneric6DofConstraint(t.ptr,n.ptr,a,u,o);d.deallocateBuffer(a,s),d.deallocateBuffer(u,s),super(e,f,y?t:[t,n])}setLinearLowerLimit(e){this._inner.hasReferences&&this.runtime.lock.wait(),this.runtime.wasmInstance.constraintSetLinearLowerLimit(this._inner.ptr,e.x,e.y,e.z)}setLinearUpperLimit(e){this._inner.hasReferences&&this.runtime.lock.wait(),this.runtime.wasmInstance.constraintSetLinearUpperLimit(this._inner.ptr,e.x,e.y,e.z)}setAngularLowerLimit(e){this._inner.hasReferences&&this.runtime.lock.wait(),this.runtime.wasmInstance.constraintSetAngularLowerLimit(this._inner.ptr,e.x,e.y,e.z)}setAngularUpperLimit(e){this._inner.hasReferences&&this.runtime.lock.wait(),this.runtime.wasmInstance.constraintSetAngularUpperLimit(this._inner.ptr,e.x,e.y,e.z)}}class c extends d{constructor(e,t,n,i,r,o){const d=e.wasmInstance,a=d.allocateBuffer(s),c=d.createTypedArray(Float32Array,a,16);i.copyToArray(c.array);const u=d.allocateBuffer(s),l=d.createTypedArray(Float32Array,u,16);r.copyToArray(l.array);const y=Array.isArray(n),f=y?d.createGeneric6DofSpringConstraintFromBundle(t.ptr,n[0],n[1],a,u,o):d.createGeneric6DofSpringConstraint(t.ptr,n.ptr,a,u,o);d.deallocateBuffer(a,s),d.deallocateBuffer(u,s),super(e,f,y?t:[t,n])}setLinearLowerLimit(e){this._inner.hasReferences&&this.runtime.lock.wait(),this.runtime.wasmInstance.constraintSetLinearLowerLimit(this._inner.ptr,e.x,e.y,e.z)}setLinearUpperLimit(e){this._inner.hasReferences&&this.runtime.lock.wait(),this.runtime.wasmInstance.constraintSetLinearUpperLimit(this._inner.ptr,e.x,e.y,e.z)}setAngularLowerLimit(e){this._inner.hasReferences&&this.runtime.lock.wait(),this.runtime.wasmInstance.constraintSetAngularLowerLimit(this._inner.ptr,e.x,e.y,e.z)}setAngularUpperLimit(e){this._inner.hasReferences&&this.runtime.lock.wait(),this.runtime.wasmInstance.constraintSetAngularUpperLimit(this._inner.ptr,e.x,e.y,e.z)}enableSpring(e,t){this._inner.hasReferences&&this.runtime.lock.wait(),this.runtime.wasmInstance.constraintEnableSpring(this._inner.ptr,e,t)}setStiffness(e,t){this._inner.hasReferences&&this.runtime.lock.wait(),this.runtime.wasmInstance.constraintSetStiffness(this._inner.ptr,e,t)}setDamping(e,t){this._inner.hasReferences&&this.runtime.lock.wait(),this.runtime.wasmInstance.constraintSetDamping(this._inner.ptr,e,t)}}},9297:(e,t,n)=>{n.r(t),n.d(t,{SceneBuilder:()=>Bn});var i={};n.r(i),n.d(i,{allocateBuffer:()=>gt,constraintEnableSpring:()=>Jt,constraintSetAngularLowerLimit:()=>Yt,constraintSetAngularUpperLimit:()=>$t,constraintSetDamping:()=>Nt,constraintSetLinearLowerLimit:()=>Kt,constraintSetLinearUpperLimit:()=>Qt,constraintSetStiffness:()=>Ht,createBoxShape:()=>Dt,createCapsuleShape:()=>Ft,createGeneric6DofConstraint:()=>xt,createGeneric6DofConstraintFromBundle:()=>Ut,createGeneric6DofSpringConstraint:()=>Et,createGeneric6DofSpringConstraintFromBundle:()=>zt,createMmdGeneric6DofSpringConstraint:()=>Ot,createMmdGeneric6DofSpringConstraintFromBundle:()=>jt,createMultiPhysicsRuntime:()=>Tt,createMultiPhysicsWorld:()=>Qe,createPhysicsRuntime:()=>Ct,createPhysicsWorld:()=>ht,createRigidBody:()=>T,createRigidBodyBundle:()=>ue,createSphereShape:()=>Vt,createStaticPlaneShape:()=>qt,deallocateBuffer:()=>Bt,default:()=>un,destroyConstraint:()=>Zt,destroyMultiPhysicsRuntime:()=>Wt,destroyMultiPhysicsWorld:()=>Ye,destroyPhysicsRuntime:()=>vt,destroyPhysicsWorld:()=>mt,destroyRigidBody:()=>W,destroyRigidBodyBundle:()=>le,destroyShape:()=>kt,init:()=>pt,initSync:()=>an,multiPhysicsRuntimeGetLockStatePtr:()=>It,multiPhysicsWorldAddConstraint:()=>ct,multiPhysicsWorldAddRigidBody:()=>He,multiPhysicsWorldAddRigidBodyBundle:()=>Xe,multiPhysicsWorldAddRigidBodyBundleShadow:()=>st,multiPhysicsWorldAddRigidBodyBundleToGlobal:()=>it,multiPhysicsWorldAddRigidBodyShadow:()=>ot,multiPhysicsWorldAddRigidBodyToGlobal:()=>tt,multiPhysicsWorldMakeBodyKinematic:()=>lt,multiPhysicsWorldRemoveConstraint:()=>ut,multiPhysicsWorldRemoveRigidBody:()=>Ne,multiPhysicsWorldRemoveRigidBodyBundle:()=>et,multiPhysicsWorldRemoveRigidBodyBundleFromGlobal:()=>rt,multiPhysicsWorldRemoveRigidBodyBundleShadow:()=>at,multiPhysicsWorldRemoveRigidBodyFromGlobal:()=>nt,multiPhysicsWorldRemoveRigidBodyShadow:()=>dt,multiPhysicsWorldRestoreBodyDynamic:()=>yt,multiPhysicsWorldSetGravity:()=>$e,multiPhysicsWorldStepSimulation:()=>Je,multiPhysicsWorldUseMotionStateBuffer:()=>ft,physicsRuntimeGetLockStatePtr:()=>Mt,physicsWorldAddConstraint:()=>_t,physicsWorldAddRigidBody:()=>Pt,physicsWorldAddRigidBodyBundle:()=>At,physicsWorldRemoveConstraint:()=>Gt,physicsWorldRemoveRigidBody:()=>Rt,physicsWorldRemoveRigidBodyBundle:()=>bt,physicsWorldSetGravity:()=>wt,physicsWorldStepSimulation:()=>St,physicsWorldUseMotionStateBuffer:()=>Lt,rigidBodyApplyCentralForce:()=>U,rigidBodyApplyCentralImpulse:()=>O,rigidBodyApplyCentralPushImpulse:()=>H,rigidBodyApplyForce:()=>z,rigidBodyApplyImpulse:()=>Z,rigidBodyApplyPushImpulse:()=>K,rigidBodyApplyTorque:()=>E,rigidBodyApplyTorqueImpulse:()=>j,rigidBodyApplyTorqueTurnImpulse:()=>N,rigidBodyBundleApplyCentralForce:()=>Re,rigidBodyBundleApplyCentralImpulse:()=>_e,rigidBodyBundleApplyCentralPushImpulse:()=>Me,rigidBodyBundleApplyForce:()=>be,rigidBodyBundleApplyImpulse:()=>Le,rigidBodyBundleApplyPushImpulse:()=>Te,rigidBodyBundleApplyTorque:()=>Ae,rigidBodyBundleApplyTorqueImpulse:()=>Ge,rigidBodyBundleApplyTorqueTurnImpulse:()=>De,rigidBodyBundleClearForces:()=>Ve,rigidBodyBundleGetAngularDamping:()=>Be,rigidBodyBundleGetAngularVelocity:()=>qe,rigidBodyBundleGetBufferedMotionStatesPtr:()=>fe,rigidBodyBundleGetLinearDamping:()=>ge,rigidBodyBundleGetLinearVelocity:()=>Fe,rigidBodyBundleGetLocalInertia:()=>we,rigidBodyBundleGetMass:()=>me,rigidBodyBundleGetMotionStatesPtr:()=>ye,rigidBodyBundleGetPushVelocity:()=>We,rigidBodyBundleGetPushVelocityInLocalPoint:()=>Ee,rigidBodyBundleGetTemporalKinematicStatesPtr:()=>Ze,rigidBodyBundleGetTotalForce:()=>Se,rigidBodyBundleGetTotalTorque:()=>Pe,rigidBodyBundleGetTurnVelocity:()=>Ie,rigidBodyBundleGetVelocityInLocalPoint:()=>Ue,rigidBodyBundleGetWorldTransformPtr:()=>je,rigidBodyBundleSetAngularVelocity:()=>xe,rigidBodyBundleSetDamping:()=>pe,rigidBodyBundleSetLinearVelocity:()=>ke,rigidBodyBundleSetMassProps:()=>he,rigidBodyBundleSetPushVelocity:()=>Ce,rigidBodyBundleSetShape:()=>Oe,rigidBodyBundleSetTurnVelocity:()=>ve,rigidBodyBundleTranslate:()=>ze,rigidBodyClearForces:()=>X,rigidBodyGetAngularDamping:()=>D,rigidBodyGetAngularVelocity:()=>te,rigidBodyGetBufferedMotionStatePtr:()=>C,rigidBodyGetLinearDamping:()=>M,rigidBodyGetLinearVelocity:()=>ee,rigidBodyGetLocalInertia:()=>q,rigidBodyGetMass:()=>F,rigidBodyGetMotionStatePtr:()=>I,rigidBodyGetPushVelocity:()=>Q,rigidBodyGetPushVelocityInLocalPoint:()=>oe,rigidBodyGetTemporalKinematicStatePtr:()=>ce,rigidBodyGetTotalForce:()=>k,rigidBodyGetTotalTorque:()=>x,rigidBodyGetTurnVelocity:()=>Y,rigidBodyGetVelocityInLocalPoint:()=>re,rigidBodyGetWorldTransformPtr:()=>ae,rigidBodySetAngularVelocity:()=>ie,rigidBodySetDamping:()=>v,rigidBodySetLinearVelocity:()=>ne,rigidBodySetMassProps:()=>V,rigidBodySetPushVelocity:()=>$,rigidBodySetShape:()=>se,rigidBodySetTurnVelocity:()=>J,rigidBodyTranslate:()=>de}),n(203),n(1503),n(8227);var r=n(7456),o=n(5581),d=n(1513),s=n(9711),a=n(6041),c=n(9923),u=n(9899),l=n(8144),y=n(554),f=n(6738),p=n(7168),g=n(3948),B=n(9009),h=n(7002);let m;const w="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&w.decode();let S=null;function P(){return null!==S&&0!==S.byteLength||(S=new Uint8Array(m.memory.buffer)),S}function R(e,t){return e>>>=0,w.decode(P().subarray(e,e+t))}const A=new Array(128).fill(void 0);A.push(void 0,null,!0,!1);let b=A.length;function _(e){b===A.length&&A.push(A.length+1);const t=b;if(b=A[t],"number"!=typeof b)throw new Error("corrupt heap");return A[t]=e,t}function G(e){return A[e]}function L(e){if("number"!=typeof e)throw new Error("expected a number argument, found "+typeof e)}function T(e){return L(e),m.createRigidBody(e)>>>0}function W(e){L(e),m.destroyRigidBody(e)}function I(e){return L(e),m.rigidBodyGetMotionStatePtr(e)>>>0}function C(e){return L(e),m.rigidBodyGetBufferedMotionStatePtr(e)>>>0}function v(e,t,n){L(e),m.rigidBodySetDamping(e,t,n)}function M(e){return L(e),m.rigidBodyGetLinearDamping(e)}function D(e){return L(e),m.rigidBodyGetAngularDamping(e)}function V(e,t,n,i,r){L(e),m.rigidBodySetMassProps(e,t,n,i,r)}function F(e){return L(e),m.rigidBodyGetMass(e)}function q(e,t){L(e),L(t),m.rigidBodyGetLocalInertia(e,t)}function k(e,t){L(e),L(t),m.rigidBodyGetTotalForce(e,t)}function x(e,t){L(e),L(t),m.rigidBodyGetTotalTorque(e,t)}function U(e,t,n,i){L(e),m.rigidBodyApplyCentralForce(e,t,n,i)}function E(e,t,n,i){L(e),m.rigidBodyApplyTorque(e,t,n,i)}function z(e,t,n){L(e),L(t),L(n),m.rigidBodyApplyForce(e,t,n)}function O(e,t,n,i){L(e),m.rigidBodyApplyCentralImpulse(e,t,n,i)}function j(e,t,n,i){L(e),m.rigidBodyApplyTorqueImpulse(e,t,n,i)}function Z(e,t,n){L(e),L(t),L(n),m.rigidBodyApplyImpulse(e,t,n)}function K(e,t,n){L(e),L(t),L(n),m.rigidBodyApplyPushImpulse(e,t,n)}function Q(e,t){L(e),L(t),m.rigidBodyGetPushVelocity(e,t)}function Y(e,t){L(e),L(t),m.rigidBodyGetTurnVelocity(e,t)}function $(e,t,n,i){L(e),m.rigidBodySetPushVelocity(e,t,n,i)}function J(e,t,n,i){L(e),m.rigidBodySetTurnVelocity(e,t,n,i)}function H(e,t,n,i){L(e),m.rigidBodyApplyCentralPushImpulse(e,t,n,i)}function N(e,t,n,i){L(e),m.rigidBodyApplyTorqueTurnImpulse(e,t,n,i)}function X(e){L(e),m.rigidBodyClearForces(e)}function ee(e,t){L(e),L(t),m.rigidBodyGetLinearVelocity(e,t)}function te(e,t){L(e),L(t),m.rigidBodyGetAngularVelocity(e,t)}function ne(e,t,n,i){L(e),m.rigidBodySetLinearVelocity(e,t,n,i)}function ie(e,t,n,i){L(e),m.rigidBodySetAngularVelocity(e,t,n,i)}function re(e,t,n){L(e),L(t),L(n),m.rigidBodyGetVelocityInLocalPoint(e,t,n)}function oe(e,t,n){L(e),L(t),L(n),m.rigidBodyGetPushVelocityInLocalPoint(e,t,n)}function de(e,t,n,i){L(e),m.rigidBodyTranslate(e,t,n,i)}function se(e,t){L(e),L(t),m.rigidBodySetShape(e,t)}function ae(e){return L(e),m.rigidBodyGetWorldTransformPtr(e)>>>0}function ce(e){return L(e),m.rigidBodyGetTemporalKinematicStatePtr(e)>>>0}function ue(e,t){return L(e),L(t),m.createRigidBodyBundle(e,t)>>>0}function le(e){L(e),m.destroyRigidBodyBundle(e)}function ye(e){return L(e),m.rigidBodyBundleGetMotionStatesPtr(e)>>>0}function fe(e){return L(e),m.rigidBodyBundleGetBufferedMotionStatesPtr(e)>>>0}function pe(e,t,n,i){L(e),L(t),m.rigidBodyBundleSetDamping(e,t,n,i)}function ge(e,t){return L(e),L(t),m.rigidBodyBundleGetLinearDamping(e,t)}function Be(e,t){return L(e),L(t),m.rigidBodyBundleGetAngularDamping(e,t)}function he(e,t,n,i,r,o){L(e),L(t),m.rigidBodyBundleSetMassProps(e,t,n,i,r,o)}function me(e,t){return L(e),L(t),m.rigidBodyBundleGetMass(e,t)}function we(e,t,n){L(e),L(t),L(n),m.rigidBodyBundleGetLocalInertia(e,t,n)}function Se(e,t,n){L(e),L(t),L(n),m.rigidBodyBundleGetTotalForce(e,t,n)}function Pe(e,t,n){L(e),L(t),L(n),m.rigidBodyBundleGetTotalTorque(e,t,n)}function Re(e,t,n,i,r){L(e),L(t),m.rigidBodyBundleApplyCentralForce(e,t,n,i,r)}function Ae(e,t,n,i,r){L(e),L(t),m.rigidBodyBundleApplyTorque(e,t,n,i,r)}function be(e,t,n,i){L(e),L(t),L(n),L(i),m.rigidBodyBundleApplyForce(e,t,n,i)}function _e(e,t,n,i,r){L(e),L(t),m.rigidBodyBundleApplyCentralImpulse(e,t,n,i,r)}function Ge(e,t,n,i,r){L(e),L(t),m.rigidBodyBundleApplyTorqueImpulse(e,t,n,i,r)}function Le(e,t,n,i){L(e),L(t),L(n),L(i),m.rigidBodyBundleApplyImpulse(e,t,n,i)}function Te(e,t,n,i){L(e),L(t),L(n),L(i),m.rigidBodyBundleApplyPushImpulse(e,t,n,i)}function We(e,t,n){L(e),L(t),L(n),m.rigidBodyBundleGetPushVelocity(e,t,n)}function Ie(e,t,n){L(e),L(t),L(n),m.rigidBodyBundleGetTurnVelocity(e,t,n)}function Ce(e,t,n,i,r){L(e),L(t),m.rigidBodyBundleSetPushVelocity(e,t,n,i,r)}function ve(e,t,n,i,r){L(e),L(t),m.rigidBodyBundleSetTurnVelocity(e,t,n,i,r)}function Me(e,t,n,i,r){L(e),L(t),m.rigidBodyBundleApplyCentralPushImpulse(e,t,n,i,r)}function De(e,t,n,i,r){L(e),L(t),m.rigidBodyBundleApplyTorqueTurnImpulse(e,t,n,i,r)}function Ve(e,t){L(e),L(t),m.rigidBodyBundleClearForces(e,t)}function Fe(e,t,n){L(e),L(t),L(n),m.rigidBodyBundleGetLinearVelocity(e,t,n)}function qe(e,t,n){L(e),L(t),L(n),m.rigidBodyBundleGetAngularVelocity(e,t,n)}function ke(e,t,n,i,r){L(e),L(t),m.rigidBodyBundleSetLinearVelocity(e,t,n,i,r)}function xe(e,t,n,i,r){L(e),L(t),m.rigidBodyBundleSetAngularVelocity(e,t,n,i,r)}function Ue(e,t,n,i){L(e),L(t),L(n),L(i),m.rigidBodyBundleGetVelocityInLocalPoint(e,t,n,i)}function Ee(e,t,n,i){L(e),L(t),L(n),L(i),m.rigidBodyBundleGetPushVelocityInLocalPoint(e,t,n,i)}function ze(e,t,n,i,r){L(e),L(t),m.rigidBodyBundleTranslate(e,t,n,i,r)}function Oe(e,t,n){L(e),L(t),L(n),m.rigidBodyBundleSetShape(e,t,n)}function je(e,t){return L(e),L(t),m.rigidBodyBundleGetWorldTransformPtr(e,t)>>>0}function Ze(e){return L(e),m.rigidBodyBundleGetTemporalKinematicStatesPtr(e)>>>0}function Ke(e){if("boolean"!=typeof e)throw new Error("expected a boolean argument, found "+typeof e)}function Qe(e){return Ke(e),m.createMultiPhysicsWorld(e)>>>0}function Ye(e){L(e),m.destroyMultiPhysicsWorld(e)}function $e(e,t,n,i){L(e),m.multiPhysicsWorldSetGravity(e,t,n,i)}function Je(e,t,n,i){L(e),L(n),m.multiPhysicsWorldStepSimulation(e,t,n,i)}function He(e,t,n){L(e),L(t),L(n),m.multiPhysicsWorldAddRigidBody(e,t,n)}function Ne(e,t,n){L(e),L(t),L(n),m.multiPhysicsWorldRemoveRigidBody(e,t,n)}function Xe(e,t,n){L(e),L(t),L(n),m.multiPhysicsWorldAddRigidBodyBundle(e,t,n)}function et(e,t,n){L(e),L(t),L(n),m.multiPhysicsWorldRemoveRigidBodyBundle(e,t,n)}function tt(e,t){L(e),L(t),m.multiPhysicsWorldAddRigidBodyToGlobal(e,t)}function nt(e,t){L(e),L(t),m.multiPhysicsWorldRemoveRigidBodyFromGlobal(e,t)}function it(e,t){L(e),L(t),m.multiPhysicsWorldAddRigidBodyBundleToGlobal(e,t)}function rt(e,t){L(e),L(t),m.multiPhysicsWorldRemoveRigidBodyBundleFromGlobal(e,t)}function ot(e,t,n){L(e),L(t),L(n),m.multiPhysicsWorldAddRigidBodyShadow(e,t,n)}function dt(e,t,n){L(e),L(t),L(n),m.multiPhysicsWorldRemoveRigidBodyShadow(e,t,n)}function st(e,t,n){L(e),L(t),L(n),m.multiPhysicsWorldAddRigidBodyBundleShadow(e,t,n)}function at(e,t,n){L(e),L(t),L(n),m.multiPhysicsWorldRemoveRigidBodyBundleShadow(e,t,n)}function ct(e,t,n,i){L(e),L(t),L(n),Ke(i),m.multiPhysicsWorldAddConstraint(e,t,n,i)}function ut(e,t,n){L(e),L(t),L(n),m.multiPhysicsWorldRemoveConstraint(e,t,n)}function lt(e,t){L(e),L(t),m.multiPhysicsWorldMakeBodyKinematic(e,t)}function yt(e,t){L(e),L(t),m.multiPhysicsWorldRestoreBodyDynamic(e,t)}function ft(e,t){L(e),Ke(t),m.multiPhysicsWorldUseMotionStateBuffer(e,t)}function pt(){m.init()}function gt(e){return L(e),m.allocateBuffer(e)>>>0}function Bt(e,t){L(e),L(t),m.deallocateBuffer(e,t)}function ht(){return m.createPhysicsWorld()>>>0}function mt(e){L(e),m.destroyPhysicsWorld(e)}function wt(e,t,n,i){L(e),m.physicsWorldSetGravity(e,t,n,i)}function St(e,t,n,i){L(e),L(n),m.physicsWorldStepSimulation(e,t,n,i)}function Pt(e,t){L(e),L(t),m.physicsWorldAddRigidBody(e,t)}function Rt(e,t){L(e),L(t),m.physicsWorldRemoveRigidBody(e,t)}function At(e,t){L(e),L(t),m.physicsWorldAddRigidBodyBundle(e,t)}function bt(e,t){L(e),L(t),m.physicsWorldRemoveRigidBodyBundle(e,t)}function _t(e,t,n){L(e),L(t),Ke(n),m.physicsWorldAddConstraint(e,t,n)}function Gt(e,t){L(e),L(t),m.physicsWorldRemoveConstraint(e,t)}function Lt(e,t){L(e),Ke(t),m.physicsWorldUseMotionStateBuffer(e,t)}function Tt(e){return L(e),m.createMultiPhysicsRuntime(e)>>>0}function Wt(e){L(e),m.destroyMultiPhysicsRuntime(e)}function It(e){return L(e),m.multiPhysicsRuntimeGetLockStatePtr(e)>>>0}function Ct(e){return L(e),m.createPhysicsRuntime(e)>>>0}function vt(e){L(e),m.destroyPhysicsRuntime(e)}function Mt(e){return L(e),m.physicsRuntimeGetLockStatePtr(e)>>>0}function Dt(e,t,n){return m.createBoxShape(e,t,n)>>>0}function Vt(e){return m.createSphereShape(e)>>>0}function Ft(e,t){return m.createCapsuleShape(e,t)>>>0}function qt(e,t,n,i){return m.createStaticPlaneShape(e,t,n,i)>>>0}function kt(e){L(e),m.destroyShape(e)}function xt(e,t,n,i,r){return L(e),L(t),L(n),L(i),Ke(r),m.createGeneric6DofConstraint(e,t,n,i,r)>>>0}function Ut(e,t,n,i,r,o){return L(e),L(t),L(n),L(i),L(r),Ke(o),m.createGeneric6DofConstraintFromBundle(e,t,n,i,r,o)>>>0}function Et(e,t,n,i,r){return L(e),L(t),L(n),L(i),Ke(r),m.createGeneric6DofSpringConstraint(e,t,n,i,r)>>>0}function zt(e,t,n,i,r,o){return L(e),L(t),L(n),L(i),L(r),Ke(o),m.createGeneric6DofSpringConstraintFromBundle(e,t,n,i,r,o)>>>0}function Ot(e,t,n,i,r){return L(e),L(t),L(n),L(i),Ke(r),m.createMmdGeneric6DofSpringConstraint(e,t,n,i,r)>>>0}function jt(e,t,n,i,r,o){return L(e),L(t),L(n),L(i),L(r),Ke(o),m.createMmdGeneric6DofSpringConstraintFromBundle(e,t,n,i,r,o)>>>0}function Zt(e){L(e),m.destroyConstraint(e)}function Kt(e,t,n,i){L(e),m.constraintSetLinearLowerLimit(e,t,n,i)}function Qt(e,t,n,i){L(e),m.constraintSetLinearUpperLimit(e,t,n,i)}function Yt(e,t,n,i){L(e),m.constraintSetAngularLowerLimit(e,t,n,i)}function $t(e,t,n,i){L(e),m.constraintSetAngularUpperLimit(e,t,n,i)}function Jt(e,t,n){L(e),L(t),Ke(n),m.constraintEnableSpring(e,t,n)}function Ht(e,t,n){L(e),L(t),m.constraintSetStiffness(e,t,n)}function Nt(e,t,n){L(e),L(t),m.constraintSetDamping(e,t,n)}function Xt(e,t){try{return e.apply(this,t)}catch(e){let t=function(){try{return e instanceof Error?`${e.message}\n\nStack:\n${e.stack}`:e.toString()}catch(e){return"<failed to stringify thrown value>"}}();throw console.error("wasm-bindgen: imported JS function that was not marked as `catch` threw an error:",t),e}}let en=0;const tn="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},nn="function"==typeof tn.encodeInto?function(e,t){return tn.encodeInto(e,t)}:function(e,t){const n=tn.encode(e);return t.set(n),{read:e.length,written:n.length}};let rn=null;function on(){return(null===rn||!0===rn.buffer.detached||void 0===rn.buffer.detached&&rn.buffer!==m.memory.buffer)&&(rn=new DataView(m.memory.buffer)),rn}function dn(){const e={wbg:{}};return e.wbg.__wbindgen_string_new=function(e,t){return _(R(e,t))},e.wbg.__wbindgen_object_drop_ref=function(e){!function(e){const t=G(e);(function(e){e<132||(A[e]=b,b=e)})(e)}(e)},e.wbg.__wbg_new_abda76e883ba8a5f=function(){return Xt((function(){return _(new Error)}),arguments)},e.wbg.__wbg_stack_658279fe44541cf6=function(){return Xt((function(e,t){const n=function(e,t,n){if("string"!=typeof e)throw new Error("expected a string argument, found "+typeof e);if(void 0===n){const n=tn.encode(e),i=t(n.length,1)>>>0;return P().subarray(i,i+n.length).set(n),en=n.length,i}let i=e.length,r=t(i,1)>>>0;const o=P();let d=0;for(;d<i;d++){const t=e.charCodeAt(d);if(t>127)break;o[r+d]=t}if(d!==i){0!==d&&(e=e.slice(d)),r=n(r,i,i=d+3*e.length,1)>>>0;const t=P().subarray(r+d,r+i),o=nn(e,t);if(o.read!==e.length)throw new Error("failed to pass whole string");d+=o.written,r=n(r,i,d,1)>>>0}return en=d,r}(G(t).stack,m.__wbindgen_malloc,m.__wbindgen_realloc),i=en;on().setInt32(e+4,i,!0),on().setInt32(e+0,n,!0)}),arguments)},e.wbg.__wbg_error_f851667af71bcfc6=function(){return Xt((function(e,t){let n,i;try{n=e,i=t,console.error(R(e,t))}finally{m.__wbindgen_free(n,i,1)}}),arguments)},e.wbg.__wbg_error_09480e4aadca50ad=function(){return Xt((function(e){console.error(G(e))}),arguments)},e.wbg.__wbg_log_b103404cc5920657=function(){return Xt((function(e){console.log(G(e))}),arguments)},e.wbg.__wbindgen_throw=function(e,t){throw new Error(R(e,t))},e}function sn(e,t){return m=e.exports,cn.__wbindgen_wasm_module=t,rn=null,S=null,m}function an(e){if(void 0!==m)return m;void 0!==e&&Object.getPrototypeOf(e)===Object.prototype?({module:e}=e):console.warn("using deprecated parameters for `initSync()`; pass a single object instead");const t=dn();return e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e)),sn(new WebAssembly.Instance(e,t),e)}async function cn(e){if(void 0!==m)return m;void 0!==e&&Object.getPrototypeOf(e)===Object.prototype?({module_or_path:e}=e):console.warn("using deprecated parameters for the initialization function; pass a single object instead"),void 0===e&&(e=new URL(n(4871),n.b));const t=dn();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:i,module:r}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return sn(i,r)}const un=cn;var ln=n(6405),yn=n(1592),fn=n(7648),pn=n(5901),gn=n(3477);class Bn{async build(e,t){const n=new y.Z(t);n.clearColor=new a.ov(.95,.95,.95,1);const i=new r.Lq("arcRotateCamera",0,0,500,new c.Pq(0,0,0),n);i.minZ=1,i.maxZ=3e3,i.setPosition(new c.Pq(60,40,-50).scaleInPlace(10)),i.attachControl(void 0,!1),i.inertia=.8,i.speed=10;const m=new d.g("hemisphericLight",new c.Pq(0,1,0),n);m.intensity=.5,m.specular=new a.v9(0,0,0),m.groundColor=new a.v9(1,1,1);const w=new o.Z("directionalLight",new c.Pq(.5,-1,1),n);w.intensity=.5;w.shadowMaxZ=250,w.shadowMinZ=-250,w.autoCalcShadowZBounds=!1,w.autoUpdateExtends=!1,w.shadowOrthoScale=0,w.orthoTop=250,w.orthoBottom=-250,w.orthoLeft=-250,w.orthoRight=250;const S=new s.o(2048,w,!0);S.transparencyShadow=!0,S.usePercentageCloserFiltering=!0,S.forceBackFacesOnly=!1,S.bias=.004,S.filteringQuality=s.o.QUALITY_MEDIUM;const P=await(0,f.e)(new h.t,32),R=new g.h(P,{allowDynamicShadow:!0,preserveBackBuffer:!0});R.register(n),R.evaluationType=B.q.Buffered;const A=new c.uq;{const e=(0,l.x)("ground",{size:500},n);e.rotationQuaternion=c.PT.RotationAxis(new c.Pq(1,0,0),Math.PI/2),S.addShadowCaster(e),e.receiveShadows=!0;const t=new ln.Ty(R,new c.Pq(0,0,-1),0),i=new pn.t(P);i.shape=t,c.uq.FromQuaternionToRef(e.rotationQuaternion,A),i.setInitialTransform(A),i.motionType=1;const r=new yn.U(R,i);R.addRigidBodyToGlobal(r)}const b=512,_=(0,u.an)("box",{size:2},n);S.addShadowCaster(_),_.receiveShadows=!0;const G=new Float32Array(262144);_.thinInstanceSetBuffer("matrix",G,16,!1);const L=new ln.SA(R,new c.Pq(1,1,1)),T=[];for(let e=0;e<4;++e)for(let t=0;t<8;++t){const n=8*e+t,i=60*(t-4)+30,r=60*(e-2)+30,o=new gn.x(P,b);for(let e=0;e<b;++e){o.setShape(e,L);const t=c.uq.TranslationToRef(i,1+2*e,r,A);o.setInitialTransform(e,t),o.setFriction(e,1),o.setLinearDamping(e,.3),o.setAngularDamping(e,.3)}const d=new fn.Y(R,o);R.addRigidBodyBundle(d,n);for(let e=0;e<b;e+=2){const t=[e,e+1],i=new p.vC(R,d,t,c.uq.Translation(0,-1.2,0),c.uq.Translation(0,1.2,0),!0);i.setLinearLowerLimit(new c.Pq(0,0,0)),i.setLinearUpperLimit(new c.Pq(0,0,0)),i.setAngularLowerLimit(new c.Pq(Math.PI/4,0,0)),i.setAngularUpperLimit(new c.Pq(0,0,0));for(let e=0;e<6;++e)i.enableSpring(e,!0),i.setStiffness(e,100),i.setDamping(e,1);R.addConstraint(i,n,!1)}T.push(d)}return R.onTickObservable.add((()=>{for(let e=0;e<T.length;++e)T[e].getTransformMatricesToArray(G,e*b*16);_.thinInstanceBufferUpdated("matrix")})),n}}}}]);