"use strict";(self.webpackChunkbabylon_bulletphysics=self.webpackChunkbabylon_bulletphysics||[]).push([[6980],{1167:(e,i,n)=>{n.d(i,{Z:()=>ki});var t={};let r;n.r(t),n.d(t,{allocateBuffer:()=>Gi,constraintEnableSpring:()=>qe,constraintSetAngularLowerLimit:()=>Fe,constraintSetAngularUpperLimit:()=>Ee,constraintSetDamping:()=>xe,constraintSetLinearLowerLimit:()=>De,constraintSetLinearUpperLimit:()=>Ve,constraintSetStiffness:()=>Ue,createBoxShape:()=>c,createCapsuleShape:()=>h,createGeneric6DofConstraint:()=>Te,createGeneric6DofConstraintFromBundle:()=>Ie,createGeneric6DofSpringConstraint:()=>ke,createGeneric6DofSpringConstraintFromBundle:()=>Me,createMultiPhysicsRuntime:()=>g,createMultiPhysicsWorld:()=>X,createPhysicsRuntime:()=>_i,createPhysicsWorld:()=>pe,createRigidBody:()=>p,createRigidBodyBundle:()=>Oe,createSphereShape:()=>y,createStaticPlaneShape:()=>f,deallocateBuffer:()=>Wi,default:()=>Ii,destroyConstraint:()=>Le,destroyMultiPhysicsRuntime:()=>m,destroyMultiPhysicsWorld:()=>$,destroyPhysicsRuntime:()=>Si,destroyPhysicsWorld:()=>we,destroyRigidBody:()=>w,destroyRigidBodyBundle:()=>je,destroyShape:()=>B,init:()=>Pi,initSync:()=>Ci,multiPhysicsRuntimeGetLockStatePtr:()=>R,multiPhysicsWorldAddConstraint:()=>fe,multiPhysicsWorldAddRigidBody:()=>ne,multiPhysicsWorldAddRigidBodyBundle:()=>re,multiPhysicsWorldAddRigidBodyBundleShadow:()=>ye,multiPhysicsWorldAddRigidBodyBundleToGlobal:()=>le,multiPhysicsWorldAddRigidBodyShadow:()=>ae,multiPhysicsWorldAddRigidBodyToGlobal:()=>de,multiPhysicsWorldMakeBodyKinematic:()=>ge,multiPhysicsWorldRemoveConstraint:()=>Be,multiPhysicsWorldRemoveRigidBody:()=>te,multiPhysicsWorldRemoveRigidBodyBundle:()=>oe,multiPhysicsWorldRemoveRigidBodyBundleFromGlobal:()=>ue,multiPhysicsWorldRemoveRigidBodyBundleShadow:()=>he,multiPhysicsWorldRemoveRigidBodyFromGlobal:()=>se,multiPhysicsWorldRemoveRigidBodyShadow:()=>ce,multiPhysicsWorldRestoreBodyDynamic:()=>me,multiPhysicsWorldSetGravity:()=>ee,multiPhysicsWorldStepSimulation:()=>ie,multiPhysicsWorldUseMotionStateBuffer:()=>Re,physicsRuntimeGetLockStatePtr:()=>bi,physicsWorldAddConstraint:()=>ve,physicsWorldAddRigidBody:()=>be,physicsWorldAddRigidBodyBundle:()=>Ge,physicsWorldRemoveConstraint:()=>Ae,physicsWorldRemoveRigidBody:()=>Pe,physicsWorldRemoveRigidBodyBundle:()=>We,physicsWorldSetGravity:()=>_e,physicsWorldStepSimulation:()=>Se,physicsWorldUseMotionStateBuffer:()=>Ce,rigidBodyApplyCentralForce:()=>I,rigidBodyApplyCentralImpulse:()=>L,rigidBodyApplyCentralPushImpulse:()=>O,rigidBodyApplyForce:()=>M,rigidBodyApplyImpulse:()=>V,rigidBodyApplyPushImpulse:()=>F,rigidBodyApplyTorque:()=>k,rigidBodyApplyTorqueImpulse:()=>D,rigidBodyApplyTorqueTurnImpulse:()=>j,rigidBodyBundleApplyCentralForce:()=>ei,rigidBodyBundleApplyCentralImpulse:()=>ti,rigidBodyBundleApplyCentralPushImpulse:()=>ci,rigidBodyBundleApplyForce:()=>ni,rigidBodyBundleApplyImpulse:()=>oi,rigidBodyBundleApplyPushImpulse:()=>di,rigidBodyBundleApplyTorque:()=>ii,rigidBodyBundleApplyTorqueImpulse:()=>ri,rigidBodyBundleApplyTorqueTurnImpulse:()=>yi,rigidBodyBundleClearForces:()=>hi,rigidBodyBundleGetAngularDamping:()=>He,rigidBodyBundleGetAngularVelocity:()=>Bi,rigidBodyBundleGetBufferedMotionStatesPtr:()=>ze,rigidBodyBundleGetLinearDamping:()=>Ze,rigidBodyBundleGetLinearVelocity:()=>fi,rigidBodyBundleGetLocalInertia:()=>Qe,rigidBodyBundleGetMass:()=>Ne,rigidBodyBundleGetMotionStatesPtr:()=>Ke,rigidBodyBundleGetPushVelocity:()=>si,rigidBodyBundleGetTemporalKinematicStatesPtr:()=>wi,rigidBodyBundleGetTotalForce:()=>Xe,rigidBodyBundleGetTotalTorque:()=>$e,rigidBodyBundleGetTurnVelocity:()=>li,rigidBodyBundleGetWorldTransformPtr:()=>pi,rigidBodyBundleSetAngularVelocity:()=>mi,rigidBodyBundleSetDamping:()=>Ye,rigidBodyBundleSetLinearVelocity:()=>gi,rigidBodyBundleSetMassProps:()=>Je,rigidBodyBundleSetPushVelocity:()=>ui,rigidBodyBundleSetTurnVelocity:()=>ai,rigidBodyBundleTranslate:()=>Ri,rigidBodyClearForces:()=>K,rigidBodyGetAngularDamping:()=>G,rigidBodyGetAngularVelocity:()=>Y,rigidBodyGetBufferedMotionStatePtr:()=>S,rigidBodyGetLinearDamping:()=>P,rigidBodyGetLinearVelocity:()=>z,rigidBodyGetLocalInertia:()=>A,rigidBodyGetMass:()=>v,rigidBodyGetMotionStatePtr:()=>_,rigidBodyGetPushVelocity:()=>E,rigidBodyGetTemporalKinematicStatePtr:()=>Q,rigidBodyGetTotalForce:()=>C,rigidBodyGetTotalTorque:()=>T,rigidBodyGetTurnVelocity:()=>q,rigidBodyGetWorldTransformPtr:()=>N,rigidBodySetAngularVelocity:()=>H,rigidBodySetDamping:()=>b,rigidBodySetLinearVelocity:()=>Z,rigidBodySetMassProps:()=>W,rigidBodySetPushVelocity:()=>U,rigidBodySetTurnVelocity:()=>x,rigidBodyTranslate:()=>J});const o="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&o.decode();let d=null;function s(e,i){return e>>>=0,o.decode((null!==d&&0!==d.byteLength||(d=new Uint8Array(r.memory.buffer)),d).subarray(e,e+i))}const l=new Array(128).fill(void 0);l.push(void 0,null,!0,!1);let u=l.length;function a(e){return l[e]}function c(e,i,n){return r.createBoxShape(e,i,n)>>>0}function y(e){return r.createSphereShape(e)>>>0}function h(e,i){return r.createCapsuleShape(e,i)>>>0}function f(e,i,n,t){return r.createStaticPlaneShape(e,i,n,t)>>>0}function B(e){r.destroyShape(e)}function g(e){return r.createMultiPhysicsRuntime(e)>>>0}function m(e){r.destroyMultiPhysicsRuntime(e)}function R(e){return r.multiPhysicsRuntimeGetLockStatePtr(e)>>>0}function p(e){return r.createRigidBody(e)>>>0}function w(e){r.destroyRigidBody(e)}function _(e){return r.rigidBodyGetMotionStatePtr(e)>>>0}function S(e){return r.rigidBodyGetBufferedMotionStatePtr(e)>>>0}function b(e,i,n){r.rigidBodySetDamping(e,i,n)}function P(e){return r.rigidBodyGetLinearDamping(e)}function G(e){return r.rigidBodyGetAngularDamping(e)}function W(e,i,n,t,o){r.rigidBodySetMassProps(e,i,n,t,o)}function v(e){return r.rigidBodyGetMass(e)}function A(e,i){r.rigidBodyGetLocalInertia(e,i)}function C(e,i){r.rigidBodyGetTotalForce(e,i)}function T(e,i){r.rigidBodyGetTotalTorque(e,i)}function I(e,i,n,t){r.rigidBodyApplyCentralForce(e,i,n,t)}function k(e,i,n,t){r.rigidBodyApplyTorque(e,i,n,t)}function M(e,i,n){r.rigidBodyApplyForce(e,i,n)}function L(e,i,n,t){r.rigidBodyApplyCentralImpulse(e,i,n,t)}function D(e,i,n,t){r.rigidBodyApplyTorqueImpulse(e,i,n,t)}function V(e,i,n){r.rigidBodyApplyImpulse(e,i,n)}function F(e,i,n){r.rigidBodyApplyPushImpulse(e,i,n)}function E(e,i){r.rigidBodyGetPushVelocity(e,i)}function q(e,i){r.rigidBodyGetTurnVelocity(e,i)}function U(e,i,n,t){r.rigidBodySetPushVelocity(e,i,n,t)}function x(e,i,n,t){r.rigidBodySetTurnVelocity(e,i,n,t)}function O(e,i,n,t){r.rigidBodyApplyCentralPushImpulse(e,i,n,t)}function j(e,i,n,t){r.rigidBodyApplyTorqueTurnImpulse(e,i,n,t)}function K(e){r.rigidBodyClearForces(e)}function z(e,i){r.rigidBodyGetLinearVelocity(e,i)}function Y(e,i){r.rigidBodyGetAngularVelocity(e,i)}function Z(e,i,n,t){r.rigidBodySetLinearVelocity(e,i,n,t)}function H(e,i,n,t){r.rigidBodySetAngularVelocity(e,i,n,t)}function J(e,i,n,t){r.rigidBodyTranslate(e,i,n,t)}function N(e){return r.rigidBodyGetWorldTransformPtr(e)>>>0}function Q(e){return r.rigidBodyGetTemporalKinematicStatePtr(e)>>>0}function X(e){return r.createMultiPhysicsWorld(e)>>>0}function $(e){r.destroyMultiPhysicsWorld(e)}function ee(e,i,n,t){r.multiPhysicsWorldSetGravity(e,i,n,t)}function ie(e,i,n,t){r.multiPhysicsWorldStepSimulation(e,i,n,t)}function ne(e,i,n){r.multiPhysicsWorldAddRigidBody(e,i,n)}function te(e,i,n){r.multiPhysicsWorldRemoveRigidBody(e,i,n)}function re(e,i,n){r.multiPhysicsWorldAddRigidBodyBundle(e,i,n)}function oe(e,i,n){r.multiPhysicsWorldRemoveRigidBodyBundle(e,i,n)}function de(e,i){r.multiPhysicsWorldAddRigidBodyToGlobal(e,i)}function se(e,i){r.multiPhysicsWorldRemoveRigidBodyFromGlobal(e,i)}function le(e,i){r.multiPhysicsWorldAddRigidBodyBundleToGlobal(e,i)}function ue(e,i){r.multiPhysicsWorldRemoveRigidBodyBundleFromGlobal(e,i)}function ae(e,i,n){r.multiPhysicsWorldAddRigidBodyShadow(e,i,n)}function ce(e,i,n){r.multiPhysicsWorldRemoveRigidBodyShadow(e,i,n)}function ye(e,i,n){r.multiPhysicsWorldAddRigidBodyBundleShadow(e,i,n)}function he(e,i,n){r.multiPhysicsWorldRemoveRigidBodyBundleShadow(e,i,n)}function fe(e,i,n,t){r.multiPhysicsWorldAddConstraint(e,i,n,t)}function Be(e,i,n){r.multiPhysicsWorldRemoveConstraint(e,i,n)}function ge(e,i){r.multiPhysicsWorldMakeBodyKinematic(e,i)}function me(e,i){r.multiPhysicsWorldRestoreBodyDynamic(e,i)}function Re(e,i){r.multiPhysicsWorldUseMotionStateBuffer(e,i)}function pe(){return r.createPhysicsWorld()>>>0}function we(e){r.destroyPhysicsWorld(e)}function _e(e,i,n,t){r.physicsWorldSetGravity(e,i,n,t)}function Se(e,i,n,t){r.physicsWorldStepSimulation(e,i,n,t)}function be(e,i){r.physicsWorldAddRigidBody(e,i)}function Pe(e,i){r.physicsWorldRemoveRigidBody(e,i)}function Ge(e,i){r.physicsWorldAddRigidBodyBundle(e,i)}function We(e,i){r.physicsWorldRemoveRigidBodyBundle(e,i)}function ve(e,i,n){r.physicsWorldAddConstraint(e,i,n)}function Ae(e,i){r.physicsWorldRemoveConstraint(e,i)}function Ce(e,i){r.physicsWorldUseMotionStateBuffer(e,i)}function Te(e,i,n,t,o){return r.createGeneric6DofConstraint(e,i,n,t,o)>>>0}function Ie(e,i,n,t,o,d){return r.createGeneric6DofConstraintFromBundle(e,i,n,t,o,d)>>>0}function ke(e,i,n,t,o){return r.createGeneric6DofSpringConstraint(e,i,n,t,o)>>>0}function Me(e,i,n,t,o,d){return r.createGeneric6DofSpringConstraintFromBundle(e,i,n,t,o,d)>>>0}function Le(e){r.destroyConstraint(e)}function De(e,i,n,t){r.constraintSetLinearLowerLimit(e,i,n,t)}function Ve(e,i,n,t){r.constraintSetLinearUpperLimit(e,i,n,t)}function Fe(e,i,n,t){r.constraintSetAngularLowerLimit(e,i,n,t)}function Ee(e,i,n,t){r.constraintSetAngularUpperLimit(e,i,n,t)}function qe(e,i,n){r.constraintEnableSpring(e,i,n)}function Ue(e,i,n){r.constraintSetStiffness(e,i,n)}function xe(e,i,n){r.constraintSetDamping(e,i,n)}function Oe(e,i){return r.createRigidBodyBundle(e,i)>>>0}function je(e){r.destroyRigidBodyBundle(e)}function Ke(e){return r.rigidBodyBundleGetMotionStatesPtr(e)>>>0}function ze(e){return r.rigidBodyBundleGetBufferedMotionStatesPtr(e)>>>0}function Ye(e,i,n,t){r.rigidBodyBundleSetDamping(e,i,n,t)}function Ze(e,i){return r.rigidBodyBundleGetLinearDamping(e,i)}function He(e,i){return r.rigidBodyBundleGetAngularDamping(e,i)}function Je(e,i,n,t,o,d){r.rigidBodyBundleSetMassProps(e,i,n,t,o,d)}function Ne(e,i){return r.rigidBodyBundleGetMass(e,i)}function Qe(e,i,n){r.rigidBodyBundleGetLocalInertia(e,i,n)}function Xe(e,i,n){r.rigidBodyBundleGetTotalForce(e,i,n)}function $e(e,i,n){r.rigidBodyBundleGetTotalTorque(e,i,n)}function ei(e,i,n,t,o){r.rigidBodyBundleApplyCentralForce(e,i,n,t,o)}function ii(e,i,n,t,o){r.rigidBodyBundleApplyTorque(e,i,n,t,o)}function ni(e,i,n,t){r.rigidBodyBundleApplyForce(e,i,n,t)}function ti(e,i,n,t,o){r.rigidBodyBundleApplyCentralImpulse(e,i,n,t,o)}function ri(e,i,n,t,o){r.rigidBodyBundleApplyTorqueImpulse(e,i,n,t,o)}function oi(e,i,n,t){r.rigidBodyBundleApplyImpulse(e,i,n,t)}function di(e,i,n,t){r.rigidBodyBundleApplyPushImpulse(e,i,n,t)}function si(e,i,n){r.rigidBodyBundleGetPushVelocity(e,i,n)}function li(e,i,n){r.rigidBodyBundleGetTurnVelocity(e,i,n)}function ui(e,i,n,t,o){r.rigidBodyBundleSetPushVelocity(e,i,n,t,o)}function ai(e,i,n,t,o){r.rigidBodyBundleSetTurnVelocity(e,i,n,t,o)}function ci(e,i,n,t,o){r.rigidBodyBundleApplyCentralPushImpulse(e,i,n,t,o)}function yi(e,i,n,t,o){r.rigidBodyBundleApplyTorqueTurnImpulse(e,i,n,t,o)}function hi(e,i){r.rigidBodyBundleClearForces(e,i)}function fi(e,i,n){r.rigidBodyBundleGetLinearVelocity(e,i,n)}function Bi(e,i,n){r.rigidBodyBundleGetAngularVelocity(e,i,n)}function gi(e,i,n,t,o){r.rigidBodyBundleSetLinearVelocity(e,i,n,t,o)}function mi(e,i,n,t,o){r.rigidBodyBundleSetAngularVelocity(e,i,n,t,o)}function Ri(e,i,n,t,o){r.rigidBodyBundleTranslate(e,i,n,t,o)}function pi(e,i){return r.rigidBodyBundleGetWorldTransformPtr(e,i)>>>0}function wi(e){return r.rigidBodyBundleGetTemporalKinematicStatesPtr(e)>>>0}function _i(e){return r.createPhysicsRuntime(e)>>>0}function Si(e){r.destroyPhysicsRuntime(e)}function bi(e){return r.physicsRuntimeGetLockStatePtr(e)>>>0}function Pi(){r.init()}function Gi(e){return r.allocateBuffer(e)>>>0}function Wi(e,i){r.deallocateBuffer(e,i)}function vi(){const e={wbg:{}};return e.wbg.__wbindgen_string_new=function(e,i){return function(e){u===l.length&&l.push(l.length+1);const i=u;return u=l[i],l[i]=e,i}(s(e,i))},e.wbg.__wbindgen_object_drop_ref=function(e){!function(e){const i=a(e);(function(e){e<132||(l[e]=u,u=e)})(e)}(e)},e.wbg.__wbg_log_b103404cc5920657=function(e){console.log(a(e))},e.wbg.__wbindgen_throw=function(e,i){throw new Error(s(e,i))},e}function Ai(e,i){return r=e.exports,Ti.__wbindgen_wasm_module=i,d=null,r}function Ci(e){if(void 0!==r)return r;void 0!==e&&Object.getPrototypeOf(e)===Object.prototype?({module:e}=e):console.warn("using deprecated parameters for `initSync()`; pass a single object instead");const i=vi();return e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e)),Ai(new WebAssembly.Instance(e,i),e)}async function Ti(e){if(void 0!==r)return r;void 0!==e&&Object.getPrototypeOf(e)===Object.prototype?({module_or_path:e}=e):console.warn("using deprecated parameters for the initialization function; pass a single object instead"),void 0===e&&(e=new URL(n(8865),n.b));const i=vi();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:t,module:o}=await async function(e,i){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,i)}catch(i){if("application/wasm"==e.headers.get("Content-Type"))throw i;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",i)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,i)}{const n=await WebAssembly.instantiate(e,i);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,i);return Ai(t,o)}const Ii=Ti;class ki{getWasmInstanceInner(){return t}}},2090:(e,i,n)=>{n.d(i,{D:()=>d});var t=n(5228),r=n(4444);class o{wait(){}}class d{wasmInstance;lock;constructor(e){this.wasmInstance=e,this.lock=new o}createRigidBodyImpl(){return new r.x}createRigidBodyBundleImpl(e){return new t.R(e.count)}}},5733:(e,i,n)=>{n.d(i,{F:()=>d});class t{_runtime;_ptr;_rigidBodyReferences;_rigidBodyBundleReferences;_rigidBodyGlobalReferences;_rigidBodyBundleGlobalReferences;_rigidBodyShadowReferences;_rigidBodyBundleShadowReferences;_constraintReferences;_referenceCount;constructor(e,i){this._runtime=e,this._ptr=i,this._rigidBodyReferences=new Map,this._rigidBodyBundleReferences=new Map,this._rigidBodyGlobalReferences=new Set,this._rigidBodyBundleGlobalReferences=new Set,this._rigidBodyShadowReferences=new Map,this._rigidBodyBundleShadowReferences=new Map,this._constraintReferences=new Set,this._referenceCount=0}dispose(){if(this._referenceCount>0)throw new Error("Cannot dispose physics world while it still has references");if(0===this._ptr)return;const e=this._runtime.deref();void 0!==e&&(e.lock.wait(),e.wasmInstance.destroyMultiPhysicsWorld(this._ptr)),this._ptr=0;for(const[e,i]of this._rigidBodyReferences)e.setWorldReference(null);this._rigidBodyReferences.clear();for(const[e,i]of this._rigidBodyBundleReferences)e.setWorldReference(null);this._rigidBodyBundleReferences.clear();for(const e of this._rigidBodyGlobalReferences)e.removeReference();this._rigidBodyGlobalReferences.clear();for(const e of this._rigidBodyBundleGlobalReferences)e.removeReference();this._rigidBodyBundleGlobalReferences.clear();for(const e of this._rigidBodyShadowReferences.values())for(const i of e)i.removeReference();this._rigidBodyShadowReferences.clear();for(const e of this._rigidBodyBundleShadowReferences.values())for(const i of e)i.removeReference();this._rigidBodyBundleShadowReferences.clear();for(const e of this._constraintReferences)e.setWorldReference(null);this._constraintReferences.clear()}get ptr(){return this._ptr}addReference(){this._referenceCount+=1}removeReference(){this._referenceCount-=1}addRigidBodyReference(e,i){if(this._rigidBodyGlobalReferences.has(e))throw new Error("Rigid body is already added to the world as a global reference");const n=this._rigidBodyShadowReferences.get(i);if(void 0!==n&&n.has(e))throw new Error("Rigid body is already added to the world as a shadow reference");return!this._rigidBodyReferences.has(e)&&(e.setWorldReference(this),this._rigidBodyReferences.set(e,i),!0)}removeRigidBodyReference(e){return!!this._rigidBodyReferences.delete(e)&&(e.setWorldReference(null),!0)}addRigidBodyBundleReference(e,i){if(this._rigidBodyBundleGlobalReferences.has(e))throw new Error("Rigid body bundle is already added to the world as a global reference");const n=this._rigidBodyBundleShadowReferences.get(i);if(void 0!==n&&n.has(e))throw new Error("Rigid body bundle is already added to the world as a shadow reference");return!this._rigidBodyBundleReferences.has(e)&&(e.setWorldReference(this),this._rigidBodyBundleReferences.set(e,i),!0)}removeRigidBodyBundleReference(e){return!!this._rigidBodyBundleReferences.delete(e)&&(e.setWorldReference(null),!0)}addRigidBodyGlobalReference(e){if(null!==e.getWorldReference())throw new Error("Rigid body is already added to the world as a strong reference");return!this._rigidBodyGlobalReferences.has(e)&&(e.addReference(),this._rigidBodyGlobalReferences.add(e),!0)}removeRigidBodyGlobalReference(e){return!!this._rigidBodyGlobalReferences.delete(e)&&(e.removeReference(),!0)}addRigidBodyBundleGlobalReference(e){if(null!==e.getWorldReference())throw new Error("Rigid body bundle is already added to the world as a strong reference");return!this._rigidBodyBundleGlobalReferences.has(e)&&(e.addReference(),this._rigidBodyBundleGlobalReferences.add(e),!0)}removeRigidBodyBundleGlobalReference(e){return!!this._rigidBodyBundleGlobalReferences.delete(e)&&(e.removeReference(),!0)}addRigidBodyShadowReference(e,i){const n=this._rigidBodyReferences.get(e);if(void 0!==n&&n===i)return!1;if(this._rigidBodyGlobalReferences.has(e))throw new Error("Rigid body is already added to the world as a global reference");let t=this._rigidBodyShadowReferences.get(i);return void 0===t&&(t=new Set,this._rigidBodyShadowReferences.set(i,t)),!t.has(e)&&(e.addReference(),t.add(e),!0)}removeRigidBodyShadowReference(e,i){const n=this._rigidBodyShadowReferences.get(i);return!(void 0===n||!n.delete(e)||(0===n.size&&this._rigidBodyShadowReferences.delete(i),e.removeReference(),0))}addRigidBodyBundleShadowReference(e,i){const n=this._rigidBodyBundleReferences.get(e);if(void 0!==n&&n===i)return!1;if(this._rigidBodyBundleGlobalReferences.has(e))throw new Error("Rigid body bundle is already added to the world as a global reference");let t=this._rigidBodyBundleShadowReferences.get(i);return void 0===t&&(t=new Set,this._rigidBodyBundleShadowReferences.set(i,t)),!t.has(e)&&(e.addReference(),t.add(e),!0)}removeRigidBodyBundleShadowReference(e,i){const n=this._rigidBodyBundleShadowReferences.get(i);return!(void 0===n||!n.delete(e)||(0===n.size&&this._rigidBodyBundleShadowReferences.delete(i),e.removeReference(),0))}addConstraintReference(e){return!this._constraintReferences.has(e)&&(e.setWorldReference(this),this._constraintReferences.add(e),!0)}removeConstraintReference(e){return!!this._constraintReferences.delete(e)&&(e.setWorldReference(null),!0)}}function r(e){e.dispose()}const o=new WeakMap;class d{_runtime;_inner;constructor(e,i){this._runtime=e;const n=e.wasmInstance.createMultiPhysicsWorld(i);this._inner=new t(new WeakRef(e),n);let d=o.get(e.wasmInstance);void 0===d&&(d=new FinalizationRegistry(r),o.set(e.wasmInstance,d)),d.register(this,this._inner,this)}dispose(){if(0===this._inner.ptr)return;this._inner.dispose();const e=o.get(this._runtime.wasmInstance);e?.unregister(this)}get ptr(){return this._inner.ptr}addReference(){this._inner.addReference()}removeReference(){this._inner.removeReference()}_nullCheck(){if(0===this._inner.ptr)throw new Error("Cannot access disposed physics world")}setGravity(e){this._nullCheck(),this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldSetGravity(this._inner.ptr,e.x,e.y,e.z)}stepSimulation(e,i,n){this._nullCheck(),this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldStepSimulation(this._inner.ptr,e,i,n)}addRigidBody(e,i){if(e.runtime!==this._runtime)throw new Error("Cannot add rigid body from a different runtime");return this._nullCheck(),!!this._inner.addRigidBodyReference(e,i)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldAddRigidBody(this._inner.ptr,i,e.ptr),!0)}removeRigidBody(e,i){if(e.hasShadows)throw new Error("Cannot remove rigid body that has shadows");return this._nullCheck(),!!this._inner.removeRigidBodyReference(e)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldRemoveRigidBody(this._inner.ptr,i,e.ptr),!0)}addRigidBodyBundle(e,i){if(e.runtime!==this._runtime)throw new Error("Cannot add rigid body bundle from a different runtime");return this._nullCheck(),!!this._inner.addRigidBodyBundleReference(e,i)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldAddRigidBodyBundle(this._inner.ptr,i,e.ptr),!0)}removeRigidBodyBundle(e,i){if(e.hasShadows)throw new Error("Cannot remove rigid body bundle that has shadows");return this._nullCheck(),!!this._inner.removeRigidBodyBundleReference(e)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldRemoveRigidBodyBundle(this._inner.ptr,i,e.ptr),!0)}addRigidBodyToGlobal(e){if(e.runtime!==this._runtime)throw new Error("Cannot add rigid body from a different runtime");if(e.isDynamic)throw new Error("Cannot add dynamic rigid body to global");return this._nullCheck(),!!this._inner.addRigidBodyGlobalReference(e)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldAddRigidBodyToGlobal(this._inner.ptr,e.ptr),!0)}removeRigidBodyFromGlobal(e){return this._nullCheck(),!!this._inner.removeRigidBodyGlobalReference(e)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldRemoveRigidBodyFromGlobal(this._inner.ptr,e.ptr),!0)}addRigidBodyBundleToGlobal(e){if(e.runtime!==this._runtime)throw new Error("Cannot add rigid body bundle from a different runtime");if(e.isContainsDynamic)throw new Error("Cannot add dynamic rigid body bundle to global");return this._nullCheck(),!!this._inner.addRigidBodyBundleGlobalReference(e)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldAddRigidBodyBundleToGlobal(this._inner.ptr,e.ptr),!0)}removeRigidBodyBundleFromGlobal(e){return this._nullCheck(),!!this._inner.removeRigidBodyBundleGlobalReference(e)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldRemoveRigidBodyBundleFromGlobal(this._inner.ptr,e.ptr),!0)}addRigidBodyShadow(e,i){if(e.runtime!==this._runtime)throw new Error("Cannot add rigid body from a different runtime");if(e.isDynamic&&null===e.getWorldReference())throw new Error("You must add dynamic rigid body first to the world before adding it as a shadow");return this._nullCheck(),!!this._inner.addRigidBodyShadowReference(e,i)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldAddRigidBodyShadow(this._inner.ptr,i,e.ptr),e.addShadowReference(),!0)}removeRigidBodyShadow(e,i){return this._nullCheck(),!!this._inner.removeRigidBodyShadowReference(e,i)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldRemoveRigidBodyShadow(this._inner.ptr,i,e.ptr),e.removeShadowReference(),!0)}addRigidBodyBundleShadow(e,i){if(e.runtime!==this._runtime)throw new Error("Cannot add rigid body bundle from a different runtime");if(e.isContainsDynamic&&null===e.getWorldReference())throw new Error("You must add dynamic rigid body bundle first to the world before adding it as a shadow");return this._nullCheck(),!!this._inner.addRigidBodyBundleShadowReference(e,i)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldAddRigidBodyBundleShadow(this._inner.ptr,i,e.ptr),e.addShadowReference(),!0)}removeRigidBodyBundleShadow(e,i){return this._nullCheck(),!!this._inner.removeRigidBodyBundleShadowReference(e,i)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldRemoveRigidBodyBundleShadow(this._inner.ptr,i,e.ptr),e.removeShadowReference(),!0)}addConstraint(e,i,n){if(e.runtime!==this._runtime)throw new Error("Cannot add constraint from a different runtime");return this._nullCheck(),!!this._inner.addConstraintReference(e)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldAddConstraint(this._inner.ptr,i,e.ptr,n),!0)}removeConstraint(e,i){return this._nullCheck(),!!this._inner.removeConstraintReference(e)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldRemoveConstraint(this._inner.ptr,i,e.ptr),!0)}}},8865:(e,i,n)=>{e.exports=n.p+"80d3455392d63feabd19.wasm"}}]);