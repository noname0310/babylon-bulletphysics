"use strict";(self.webpackChunkbabylon_bulletphysics=self.webpackChunkbabylon_bulletphysics||[]).push([[6980],{1167:(e,i,n)=>{n.d(i,{Z:()=>Di});var t={};let r;n.r(t),n.d(t,{allocateBuffer:()=>Ci,constraintEnableSpring:()=>xe,constraintSetAngularLowerLimit:()=>qe,constraintSetAngularUpperLimit:()=>Ue,constraintSetDamping:()=>je,constraintSetLinearLowerLimit:()=>Fe,constraintSetLinearUpperLimit:()=>Ee,constraintSetStiffness:()=>Oe,createBoxShape:()=>a,createCapsuleShape:()=>h,createGeneric6DofConstraint:()=>ke,createGeneric6DofConstraintFromBundle:()=>Le,createGeneric6DofSpringConstraint:()=>Me,createGeneric6DofSpringConstraintFromBundle:()=>Ve,createMultiPhysicsRuntime:()=>g,createMultiPhysicsWorld:()=>ee,createPhysicsRuntime:()=>Gi,createPhysicsWorld:()=>_e,createRigidBody:()=>p,createRigidBodyBundle:()=>Ke,createSphereShape:()=>y,createStaticPlaneShape:()=>B,deallocateBuffer:()=>Ii,default:()=>Vi,destroyConstraint:()=>De,destroyMultiPhysicsRuntime:()=>m,destroyMultiPhysicsWorld:()=>ie,destroyPhysicsRuntime:()=>Wi,destroyPhysicsWorld:()=>Se,destroyRigidBody:()=>w,destroyRigidBodyBundle:()=>ze,destroyShape:()=>f,init:()=>Ai,initSync:()=>Li,multiPhysicsRuntimeGetLockStatePtr:()=>R,multiPhysicsWorldAddConstraint:()=>ge,multiPhysicsWorldAddRigidBody:()=>re,multiPhysicsWorldAddRigidBodyBundle:()=>de,multiPhysicsWorldAddRigidBodyBundleShadow:()=>Be,multiPhysicsWorldAddRigidBodyBundleToGlobal:()=>ce,multiPhysicsWorldAddRigidBodyShadow:()=>ye,multiPhysicsWorldAddRigidBodyToGlobal:()=>le,multiPhysicsWorldMakeBodyKinematic:()=>Re,multiPhysicsWorldRemoveConstraint:()=>me,multiPhysicsWorldRemoveRigidBody:()=>oe,multiPhysicsWorldRemoveRigidBodyBundle:()=>se,multiPhysicsWorldRemoveRigidBodyBundleFromGlobal:()=>ae,multiPhysicsWorldRemoveRigidBodyBundleShadow:()=>fe,multiPhysicsWorldRemoveRigidBodyFromGlobal:()=>ue,multiPhysicsWorldRemoveRigidBodyShadow:()=>he,multiPhysicsWorldRestoreBodyDynamic:()=>pe,multiPhysicsWorldSetGravity:()=>ne,multiPhysicsWorldStepSimulation:()=>te,multiPhysicsWorldUseMotionStateBuffer:()=>we,physicsRuntimeGetLockStatePtr:()=>vi,physicsWorldAddConstraint:()=>Ce,physicsWorldAddRigidBody:()=>Ge,physicsWorldAddRigidBodyBundle:()=>ve,physicsWorldRemoveConstraint:()=>Ie,physicsWorldRemoveRigidBody:()=>We,physicsWorldRemoveRigidBodyBundle:()=>Ae,physicsWorldSetGravity:()=>be,physicsWorldStepSimulation:()=>Pe,physicsWorldUseMotionStateBuffer:()=>Te,rigidBodyApplyCentralForce:()=>T,rigidBodyApplyCentralImpulse:()=>M,rigidBodyApplyCentralPushImpulse:()=>O,rigidBodyApplyForce:()=>L,rigidBodyApplyImpulse:()=>D,rigidBodyApplyPushImpulse:()=>F,rigidBodyApplyTorque:()=>k,rigidBodyApplyTorqueImpulse:()=>V,rigidBodyApplyTorqueTurnImpulse:()=>j,rigidBodyBundleApplyCentralForce:()=>ni,rigidBodyBundleApplyCentralImpulse:()=>oi,rigidBodyBundleApplyCentralPushImpulse:()=>hi,rigidBodyBundleApplyForce:()=>ri,rigidBodyBundleApplyImpulse:()=>si,rigidBodyBundleApplyPushImpulse:()=>li,rigidBodyBundleApplyTorque:()=>ti,rigidBodyBundleApplyTorqueImpulse:()=>di,rigidBodyBundleApplyTorqueTurnImpulse:()=>Bi,rigidBodyBundleClearForces:()=>fi,rigidBodyBundleGetAngularDamping:()=>Ne,rigidBodyBundleGetAngularVelocity:()=>mi,rigidBodyBundleGetBufferedMotionStatesPtr:()=>Ze,rigidBodyBundleGetLinearDamping:()=>Je,rigidBodyBundleGetLinearVelocity:()=>gi,rigidBodyBundleGetLocalInertia:()=>$e,rigidBodyBundleGetMass:()=>Xe,rigidBodyBundleGetMotionStatesPtr:()=>Ye,rigidBodyBundleGetPushVelocity:()=>ui,rigidBodyBundleGetPushVelocityInLocalPoint:()=>_i,rigidBodyBundleGetTemporalKinematicStatesPtr:()=>Pi,rigidBodyBundleGetTotalForce:()=>ei,rigidBodyBundleGetTotalTorque:()=>ii,rigidBodyBundleGetTurnVelocity:()=>ci,rigidBodyBundleGetVelocityInLocalPoint:()=>wi,rigidBodyBundleGetWorldTransformPtr:()=>bi,rigidBodyBundleSetAngularVelocity:()=>pi,rigidBodyBundleSetDamping:()=>He,rigidBodyBundleSetLinearVelocity:()=>Ri,rigidBodyBundleSetMassProps:()=>Qe,rigidBodyBundleSetPushVelocity:()=>ai,rigidBodyBundleSetTurnVelocity:()=>yi,rigidBodyBundleTranslate:()=>Si,rigidBodyClearForces:()=>K,rigidBodyGetAngularDamping:()=>G,rigidBodyGetAngularVelocity:()=>Y,rigidBodyGetBufferedMotionStatePtr:()=>S,rigidBodyGetLinearDamping:()=>P,rigidBodyGetLinearVelocity:()=>z,rigidBodyGetLocalInertia:()=>A,rigidBodyGetMass:()=>v,rigidBodyGetMotionStatePtr:()=>_,rigidBodyGetPushVelocity:()=>E,rigidBodyGetPushVelocityInLocalPoint:()=>N,rigidBodyGetTemporalKinematicStatePtr:()=>$,rigidBodyGetTotalForce:()=>C,rigidBodyGetTotalTorque:()=>I,rigidBodyGetTurnVelocity:()=>q,rigidBodyGetVelocityInLocalPoint:()=>J,rigidBodyGetWorldTransformPtr:()=>X,rigidBodySetAngularVelocity:()=>H,rigidBodySetDamping:()=>b,rigidBodySetLinearVelocity:()=>Z,rigidBodySetMassProps:()=>W,rigidBodySetPushVelocity:()=>U,rigidBodySetTurnVelocity:()=>x,rigidBodyTranslate:()=>Q});const o="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&o.decode();let d=null;function s(e,i){return e>>>=0,o.decode((null!==d&&0!==d.byteLength||(d=new Uint8Array(r.memory.buffer)),d).subarray(e,e+i))}const l=new Array(128).fill(void 0);l.push(void 0,null,!0,!1);let u=l.length;function c(e){return l[e]}function a(e,i,n){return r.createBoxShape(e,i,n)>>>0}function y(e){return r.createSphereShape(e)>>>0}function h(e,i){return r.createCapsuleShape(e,i)>>>0}function B(e,i,n,t){return r.createStaticPlaneShape(e,i,n,t)>>>0}function f(e){r.destroyShape(e)}function g(e){return r.createMultiPhysicsRuntime(e)>>>0}function m(e){r.destroyMultiPhysicsRuntime(e)}function R(e){return r.multiPhysicsRuntimeGetLockStatePtr(e)>>>0}function p(e){return r.createRigidBody(e)>>>0}function w(e){r.destroyRigidBody(e)}function _(e){return r.rigidBodyGetMotionStatePtr(e)>>>0}function S(e){return r.rigidBodyGetBufferedMotionStatePtr(e)>>>0}function b(e,i,n){r.rigidBodySetDamping(e,i,n)}function P(e){return r.rigidBodyGetLinearDamping(e)}function G(e){return r.rigidBodyGetAngularDamping(e)}function W(e,i,n,t,o){r.rigidBodySetMassProps(e,i,n,t,o)}function v(e){return r.rigidBodyGetMass(e)}function A(e,i){r.rigidBodyGetLocalInertia(e,i)}function C(e,i){r.rigidBodyGetTotalForce(e,i)}function I(e,i){r.rigidBodyGetTotalTorque(e,i)}function T(e,i,n,t){r.rigidBodyApplyCentralForce(e,i,n,t)}function k(e,i,n,t){r.rigidBodyApplyTorque(e,i,n,t)}function L(e,i,n){r.rigidBodyApplyForce(e,i,n)}function M(e,i,n,t){r.rigidBodyApplyCentralImpulse(e,i,n,t)}function V(e,i,n,t){r.rigidBodyApplyTorqueImpulse(e,i,n,t)}function D(e,i,n){r.rigidBodyApplyImpulse(e,i,n)}function F(e,i,n){r.rigidBodyApplyPushImpulse(e,i,n)}function E(e,i){r.rigidBodyGetPushVelocity(e,i)}function q(e,i){r.rigidBodyGetTurnVelocity(e,i)}function U(e,i,n,t){r.rigidBodySetPushVelocity(e,i,n,t)}function x(e,i,n,t){r.rigidBodySetTurnVelocity(e,i,n,t)}function O(e,i,n,t){r.rigidBodyApplyCentralPushImpulse(e,i,n,t)}function j(e,i,n,t){r.rigidBodyApplyTorqueTurnImpulse(e,i,n,t)}function K(e){r.rigidBodyClearForces(e)}function z(e,i){r.rigidBodyGetLinearVelocity(e,i)}function Y(e,i){r.rigidBodyGetAngularVelocity(e,i)}function Z(e,i,n,t){r.rigidBodySetLinearVelocity(e,i,n,t)}function H(e,i,n,t){r.rigidBodySetAngularVelocity(e,i,n,t)}function J(e,i,n){r.rigidBodyGetVelocityInLocalPoint(e,i,n)}function N(e,i,n){r.rigidBodyGetPushVelocityInLocalPoint(e,i,n)}function Q(e,i,n,t){r.rigidBodyTranslate(e,i,n,t)}function X(e){return r.rigidBodyGetWorldTransformPtr(e)>>>0}function $(e){return r.rigidBodyGetTemporalKinematicStatePtr(e)>>>0}function ee(e){return r.createMultiPhysicsWorld(e)>>>0}function ie(e){r.destroyMultiPhysicsWorld(e)}function ne(e,i,n,t){r.multiPhysicsWorldSetGravity(e,i,n,t)}function te(e,i,n,t){r.multiPhysicsWorldStepSimulation(e,i,n,t)}function re(e,i,n){r.multiPhysicsWorldAddRigidBody(e,i,n)}function oe(e,i,n){r.multiPhysicsWorldRemoveRigidBody(e,i,n)}function de(e,i,n){r.multiPhysicsWorldAddRigidBodyBundle(e,i,n)}function se(e,i,n){r.multiPhysicsWorldRemoveRigidBodyBundle(e,i,n)}function le(e,i){r.multiPhysicsWorldAddRigidBodyToGlobal(e,i)}function ue(e,i){r.multiPhysicsWorldRemoveRigidBodyFromGlobal(e,i)}function ce(e,i){r.multiPhysicsWorldAddRigidBodyBundleToGlobal(e,i)}function ae(e,i){r.multiPhysicsWorldRemoveRigidBodyBundleFromGlobal(e,i)}function ye(e,i,n){r.multiPhysicsWorldAddRigidBodyShadow(e,i,n)}function he(e,i,n){r.multiPhysicsWorldRemoveRigidBodyShadow(e,i,n)}function Be(e,i,n){r.multiPhysicsWorldAddRigidBodyBundleShadow(e,i,n)}function fe(e,i,n){r.multiPhysicsWorldRemoveRigidBodyBundleShadow(e,i,n)}function ge(e,i,n,t){r.multiPhysicsWorldAddConstraint(e,i,n,t)}function me(e,i,n){r.multiPhysicsWorldRemoveConstraint(e,i,n)}function Re(e,i){r.multiPhysicsWorldMakeBodyKinematic(e,i)}function pe(e,i){r.multiPhysicsWorldRestoreBodyDynamic(e,i)}function we(e,i){r.multiPhysicsWorldUseMotionStateBuffer(e,i)}function _e(){return r.createPhysicsWorld()>>>0}function Se(e){r.destroyPhysicsWorld(e)}function be(e,i,n,t){r.physicsWorldSetGravity(e,i,n,t)}function Pe(e,i,n,t){r.physicsWorldStepSimulation(e,i,n,t)}function Ge(e,i){r.physicsWorldAddRigidBody(e,i)}function We(e,i){r.physicsWorldRemoveRigidBody(e,i)}function ve(e,i){r.physicsWorldAddRigidBodyBundle(e,i)}function Ae(e,i){r.physicsWorldRemoveRigidBodyBundle(e,i)}function Ce(e,i,n){r.physicsWorldAddConstraint(e,i,n)}function Ie(e,i){r.physicsWorldRemoveConstraint(e,i)}function Te(e,i){r.physicsWorldUseMotionStateBuffer(e,i)}function ke(e,i,n,t,o){return r.createGeneric6DofConstraint(e,i,n,t,o)>>>0}function Le(e,i,n,t,o,d){return r.createGeneric6DofConstraintFromBundle(e,i,n,t,o,d)>>>0}function Me(e,i,n,t,o){return r.createGeneric6DofSpringConstraint(e,i,n,t,o)>>>0}function Ve(e,i,n,t,o,d){return r.createGeneric6DofSpringConstraintFromBundle(e,i,n,t,o,d)>>>0}function De(e){r.destroyConstraint(e)}function Fe(e,i,n,t){r.constraintSetLinearLowerLimit(e,i,n,t)}function Ee(e,i,n,t){r.constraintSetLinearUpperLimit(e,i,n,t)}function qe(e,i,n,t){r.constraintSetAngularLowerLimit(e,i,n,t)}function Ue(e,i,n,t){r.constraintSetAngularUpperLimit(e,i,n,t)}function xe(e,i,n){r.constraintEnableSpring(e,i,n)}function Oe(e,i,n){r.constraintSetStiffness(e,i,n)}function je(e,i,n){r.constraintSetDamping(e,i,n)}function Ke(e,i){return r.createRigidBodyBundle(e,i)>>>0}function ze(e){r.destroyRigidBodyBundle(e)}function Ye(e){return r.rigidBodyBundleGetMotionStatesPtr(e)>>>0}function Ze(e){return r.rigidBodyBundleGetBufferedMotionStatesPtr(e)>>>0}function He(e,i,n,t){r.rigidBodyBundleSetDamping(e,i,n,t)}function Je(e,i){return r.rigidBodyBundleGetLinearDamping(e,i)}function Ne(e,i){return r.rigidBodyBundleGetAngularDamping(e,i)}function Qe(e,i,n,t,o,d){r.rigidBodyBundleSetMassProps(e,i,n,t,o,d)}function Xe(e,i){return r.rigidBodyBundleGetMass(e,i)}function $e(e,i,n){r.rigidBodyBundleGetLocalInertia(e,i,n)}function ei(e,i,n){r.rigidBodyBundleGetTotalForce(e,i,n)}function ii(e,i,n){r.rigidBodyBundleGetTotalTorque(e,i,n)}function ni(e,i,n,t,o){r.rigidBodyBundleApplyCentralForce(e,i,n,t,o)}function ti(e,i,n,t,o){r.rigidBodyBundleApplyTorque(e,i,n,t,o)}function ri(e,i,n,t){r.rigidBodyBundleApplyForce(e,i,n,t)}function oi(e,i,n,t,o){r.rigidBodyBundleApplyCentralImpulse(e,i,n,t,o)}function di(e,i,n,t,o){r.rigidBodyBundleApplyTorqueImpulse(e,i,n,t,o)}function si(e,i,n,t){r.rigidBodyBundleApplyImpulse(e,i,n,t)}function li(e,i,n,t){r.rigidBodyBundleApplyPushImpulse(e,i,n,t)}function ui(e,i,n){r.rigidBodyBundleGetPushVelocity(e,i,n)}function ci(e,i,n){r.rigidBodyBundleGetTurnVelocity(e,i,n)}function ai(e,i,n,t,o){r.rigidBodyBundleSetPushVelocity(e,i,n,t,o)}function yi(e,i,n,t,o){r.rigidBodyBundleSetTurnVelocity(e,i,n,t,o)}function hi(e,i,n,t,o){r.rigidBodyBundleApplyCentralPushImpulse(e,i,n,t,o)}function Bi(e,i,n,t,o){r.rigidBodyBundleApplyTorqueTurnImpulse(e,i,n,t,o)}function fi(e,i){r.rigidBodyBundleClearForces(e,i)}function gi(e,i,n){r.rigidBodyBundleGetLinearVelocity(e,i,n)}function mi(e,i,n){r.rigidBodyBundleGetAngularVelocity(e,i,n)}function Ri(e,i,n,t,o){r.rigidBodyBundleSetLinearVelocity(e,i,n,t,o)}function pi(e,i,n,t,o){r.rigidBodyBundleSetAngularVelocity(e,i,n,t,o)}function wi(e,i,n,t){r.rigidBodyBundleGetVelocityInLocalPoint(e,i,n,t)}function _i(e,i,n,t){r.rigidBodyBundleGetPushVelocityInLocalPoint(e,i,n,t)}function Si(e,i,n,t,o){r.rigidBodyBundleTranslate(e,i,n,t,o)}function bi(e,i){return r.rigidBodyBundleGetWorldTransformPtr(e,i)>>>0}function Pi(e){return r.rigidBodyBundleGetTemporalKinematicStatesPtr(e)>>>0}function Gi(e){return r.createPhysicsRuntime(e)>>>0}function Wi(e){r.destroyPhysicsRuntime(e)}function vi(e){return r.physicsRuntimeGetLockStatePtr(e)>>>0}function Ai(){r.init()}function Ci(e){return r.allocateBuffer(e)>>>0}function Ii(e,i){r.deallocateBuffer(e,i)}function Ti(){const e={wbg:{}};return e.wbg.__wbindgen_string_new=function(e,i){return function(e){u===l.length&&l.push(l.length+1);const i=u;return u=l[i],l[i]=e,i}(s(e,i))},e.wbg.__wbindgen_object_drop_ref=function(e){!function(e){const i=c(e);(function(e){e<132||(l[e]=u,u=e)})(e)}(e)},e.wbg.__wbg_log_b103404cc5920657=function(e){console.log(c(e))},e.wbg.__wbindgen_throw=function(e,i){throw new Error(s(e,i))},e}function ki(e,i){return r=e.exports,Mi.__wbindgen_wasm_module=i,d=null,r}function Li(e){if(void 0!==r)return r;void 0!==e&&Object.getPrototypeOf(e)===Object.prototype?({module:e}=e):console.warn("using deprecated parameters for `initSync()`; pass a single object instead");const i=Ti();return e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e)),ki(new WebAssembly.Instance(e,i),e)}async function Mi(e){if(void 0!==r)return r;void 0!==e&&Object.getPrototypeOf(e)===Object.prototype?({module_or_path:e}=e):console.warn("using deprecated parameters for the initialization function; pass a single object instead"),void 0===e&&(e=new URL(n(8865),n.b));const i=Ti();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:t,module:o}=await async function(e,i){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,i)}catch(i){if("application/wasm"==e.headers.get("Content-Type"))throw i;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",i)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,i)}{const n=await WebAssembly.instantiate(e,i);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,i);return ki(t,o)}const Vi=Mi;class Di{getWasmInstanceInner(){return t}}},2090:(e,i,n)=>{n.d(i,{D:()=>d});var t=n(5228),r=n(4444);class o{wait(){}}class d{wasmInstance;lock;constructor(e){this.wasmInstance=e,this.lock=new o}createRigidBodyImpl(){return new r.x}createRigidBodyBundleImpl(e){return new t.R(e.count)}}},5733:(e,i,n)=>{n.d(i,{F:()=>d});class t{_runtime;_ptr;_rigidBodyReferences;_rigidBodyBundleReferences;_rigidBodyGlobalReferences;_rigidBodyBundleGlobalReferences;_rigidBodyShadowReferences;_rigidBodyBundleShadowReferences;_constraintReferences;_referenceCount;constructor(e,i){this._runtime=e,this._ptr=i,this._rigidBodyReferences=new Map,this._rigidBodyBundleReferences=new Map,this._rigidBodyGlobalReferences=new Set,this._rigidBodyBundleGlobalReferences=new Set,this._rigidBodyShadowReferences=new Map,this._rigidBodyBundleShadowReferences=new Map,this._constraintReferences=new Set,this._referenceCount=0}dispose(){if(this._referenceCount>0)throw new Error("Cannot dispose physics world while it still has references");if(0===this._ptr)return;const e=this._runtime.deref();void 0!==e&&(e.lock.wait(),e.wasmInstance.destroyMultiPhysicsWorld(this._ptr)),this._ptr=0;for(const[e,i]of this._rigidBodyReferences)e.setWorldReference(null);this._rigidBodyReferences.clear();for(const[e,i]of this._rigidBodyBundleReferences)e.setWorldReference(null);this._rigidBodyBundleReferences.clear();for(const e of this._rigidBodyGlobalReferences)e.removeReference();this._rigidBodyGlobalReferences.clear();for(const e of this._rigidBodyBundleGlobalReferences)e.removeReference();this._rigidBodyBundleGlobalReferences.clear();for(const e of this._rigidBodyShadowReferences.values())for(const i of e)i.removeReference();this._rigidBodyShadowReferences.clear();for(const e of this._rigidBodyBundleShadowReferences.values())for(const i of e)i.removeReference();this._rigidBodyBundleShadowReferences.clear();for(const e of this._constraintReferences)e.setWorldReference(null);this._constraintReferences.clear()}get ptr(){return this._ptr}addReference(){this._referenceCount+=1}removeReference(){this._referenceCount-=1}addRigidBodyReference(e,i){if(this._rigidBodyGlobalReferences.has(e))throw new Error("Rigid body is already added to the world as a global reference");const n=this._rigidBodyShadowReferences.get(i);if(void 0!==n&&n.has(e))throw new Error("Rigid body is already added to the world as a shadow reference");return!this._rigidBodyReferences.has(e)&&(e.setWorldReference(this),this._rigidBodyReferences.set(e,i),!0)}removeRigidBodyReference(e){return!!this._rigidBodyReferences.delete(e)&&(e.setWorldReference(null),!0)}addRigidBodyBundleReference(e,i){if(this._rigidBodyBundleGlobalReferences.has(e))throw new Error("Rigid body bundle is already added to the world as a global reference");const n=this._rigidBodyBundleShadowReferences.get(i);if(void 0!==n&&n.has(e))throw new Error("Rigid body bundle is already added to the world as a shadow reference");return!this._rigidBodyBundleReferences.has(e)&&(e.setWorldReference(this),this._rigidBodyBundleReferences.set(e,i),!0)}removeRigidBodyBundleReference(e){return!!this._rigidBodyBundleReferences.delete(e)&&(e.setWorldReference(null),!0)}addRigidBodyGlobalReference(e){if(null!==e.getWorldReference())throw new Error("Rigid body is already added to the world as a strong reference");return!this._rigidBodyGlobalReferences.has(e)&&(e.addReference(),this._rigidBodyGlobalReferences.add(e),!0)}removeRigidBodyGlobalReference(e){return!!this._rigidBodyGlobalReferences.delete(e)&&(e.removeReference(),!0)}addRigidBodyBundleGlobalReference(e){if(null!==e.getWorldReference())throw new Error("Rigid body bundle is already added to the world as a strong reference");return!this._rigidBodyBundleGlobalReferences.has(e)&&(e.addReference(),this._rigidBodyBundleGlobalReferences.add(e),!0)}removeRigidBodyBundleGlobalReference(e){return!!this._rigidBodyBundleGlobalReferences.delete(e)&&(e.removeReference(),!0)}addRigidBodyShadowReference(e,i){const n=this._rigidBodyReferences.get(e);if(void 0!==n&&n===i)return!1;if(this._rigidBodyGlobalReferences.has(e))throw new Error("Rigid body is already added to the world as a global reference");let t=this._rigidBodyShadowReferences.get(i);return void 0===t&&(t=new Set,this._rigidBodyShadowReferences.set(i,t)),!t.has(e)&&(e.addReference(),t.add(e),!0)}removeRigidBodyShadowReference(e,i){const n=this._rigidBodyShadowReferences.get(i);return!(void 0===n||!n.delete(e)||(0===n.size&&this._rigidBodyShadowReferences.delete(i),e.removeReference(),0))}addRigidBodyBundleShadowReference(e,i){const n=this._rigidBodyBundleReferences.get(e);if(void 0!==n&&n===i)return!1;if(this._rigidBodyBundleGlobalReferences.has(e))throw new Error("Rigid body bundle is already added to the world as a global reference");let t=this._rigidBodyBundleShadowReferences.get(i);return void 0===t&&(t=new Set,this._rigidBodyBundleShadowReferences.set(i,t)),!t.has(e)&&(e.addReference(),t.add(e),!0)}removeRigidBodyBundleShadowReference(e,i){const n=this._rigidBodyBundleShadowReferences.get(i);return!(void 0===n||!n.delete(e)||(0===n.size&&this._rigidBodyBundleShadowReferences.delete(i),e.removeReference(),0))}addConstraintReference(e){return!this._constraintReferences.has(e)&&(e.setWorldReference(this),this._constraintReferences.add(e),!0)}removeConstraintReference(e){return!!this._constraintReferences.delete(e)&&(e.setWorldReference(null),!0)}}function r(e){e.dispose()}const o=new WeakMap;class d{_runtime;_inner;constructor(e,i){this._runtime=e;const n=e.wasmInstance.createMultiPhysicsWorld(i);this._inner=new t(new WeakRef(e),n);let d=o.get(e.wasmInstance);void 0===d&&(d=new FinalizationRegistry(r),o.set(e.wasmInstance,d)),d.register(this,this._inner,this)}dispose(){if(0===this._inner.ptr)return;this._inner.dispose();const e=o.get(this._runtime.wasmInstance);e?.unregister(this)}get ptr(){return this._inner.ptr}addReference(){this._inner.addReference()}removeReference(){this._inner.removeReference()}_nullCheck(){if(0===this._inner.ptr)throw new Error("Cannot access disposed physics world")}setGravity(e){this._nullCheck(),this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldSetGravity(this._inner.ptr,e.x,e.y,e.z)}stepSimulation(e,i,n){this._nullCheck(),this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldStepSimulation(this._inner.ptr,e,i,n)}addRigidBody(e,i){if(e.runtime!==this._runtime)throw new Error("Cannot add rigid body from a different runtime");return this._nullCheck(),!!this._inner.addRigidBodyReference(e,i)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldAddRigidBody(this._inner.ptr,i,e.ptr),!0)}removeRigidBody(e,i){if(e.hasShadows)throw new Error("Cannot remove rigid body that has shadows");return this._nullCheck(),!!this._inner.removeRigidBodyReference(e)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldRemoveRigidBody(this._inner.ptr,i,e.ptr),!0)}addRigidBodyBundle(e,i){if(e.runtime!==this._runtime)throw new Error("Cannot add rigid body bundle from a different runtime");return this._nullCheck(),!!this._inner.addRigidBodyBundleReference(e,i)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldAddRigidBodyBundle(this._inner.ptr,i,e.ptr),!0)}removeRigidBodyBundle(e,i){if(e.hasShadows)throw new Error("Cannot remove rigid body bundle that has shadows");return this._nullCheck(),!!this._inner.removeRigidBodyBundleReference(e)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldRemoveRigidBodyBundle(this._inner.ptr,i,e.ptr),!0)}addRigidBodyToGlobal(e){if(e.runtime!==this._runtime)throw new Error("Cannot add rigid body from a different runtime");if(e.isDynamic)throw new Error("Cannot add dynamic rigid body to global");return this._nullCheck(),!!this._inner.addRigidBodyGlobalReference(e)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldAddRigidBodyToGlobal(this._inner.ptr,e.ptr),!0)}removeRigidBodyFromGlobal(e){return this._nullCheck(),!!this._inner.removeRigidBodyGlobalReference(e)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldRemoveRigidBodyFromGlobal(this._inner.ptr,e.ptr),!0)}addRigidBodyBundleToGlobal(e){if(e.runtime!==this._runtime)throw new Error("Cannot add rigid body bundle from a different runtime");if(e.isContainsDynamic)throw new Error("Cannot add dynamic rigid body bundle to global");return this._nullCheck(),!!this._inner.addRigidBodyBundleGlobalReference(e)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldAddRigidBodyBundleToGlobal(this._inner.ptr,e.ptr),!0)}removeRigidBodyBundleFromGlobal(e){return this._nullCheck(),!!this._inner.removeRigidBodyBundleGlobalReference(e)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldRemoveRigidBodyBundleFromGlobal(this._inner.ptr,e.ptr),!0)}addRigidBodyShadow(e,i){if(e.runtime!==this._runtime)throw new Error("Cannot add rigid body from a different runtime");if(e.isDynamic&&null===e.getWorldReference())throw new Error("You must add dynamic rigid body first to the world before adding it as a shadow");return this._nullCheck(),!!this._inner.addRigidBodyShadowReference(e,i)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldAddRigidBodyShadow(this._inner.ptr,i,e.ptr),e.addShadowReference(),!0)}removeRigidBodyShadow(e,i){return this._nullCheck(),!!this._inner.removeRigidBodyShadowReference(e,i)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldRemoveRigidBodyShadow(this._inner.ptr,i,e.ptr),e.removeShadowReference(),!0)}addRigidBodyBundleShadow(e,i){if(e.runtime!==this._runtime)throw new Error("Cannot add rigid body bundle from a different runtime");if(e.isContainsDynamic&&null===e.getWorldReference())throw new Error("You must add dynamic rigid body bundle first to the world before adding it as a shadow");return this._nullCheck(),!!this._inner.addRigidBodyBundleShadowReference(e,i)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldAddRigidBodyBundleShadow(this._inner.ptr,i,e.ptr),e.addShadowReference(),!0)}removeRigidBodyBundleShadow(e,i){return this._nullCheck(),!!this._inner.removeRigidBodyBundleShadowReference(e,i)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldRemoveRigidBodyBundleShadow(this._inner.ptr,i,e.ptr),e.removeShadowReference(),!0)}addConstraint(e,i,n){if(e.runtime!==this._runtime)throw new Error("Cannot add constraint from a different runtime");return this._nullCheck(),!!this._inner.addConstraintReference(e)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldAddConstraint(this._inner.ptr,i,e.ptr,n),!0)}removeConstraint(e,i){return this._nullCheck(),!!this._inner.removeConstraintReference(e)&&(this._runtime.lock.wait(),this._runtime.wasmInstance.multiPhysicsWorldRemoveConstraint(this._inner.ptr,i,e.ptr),!0)}}},8865:(e,i,n)=>{e.exports=n.p+"5ead9105b87fdbc7912a.wasm"}}]);